(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{101:function(e,t,r){"use strict";function n(e){return e<10?"has-".concat(e,"-items"):"has-10-items"}r.d(t,"a",(function(){return n}))},133:function(e,t,r){"use strict";var n=r(0),a=r(10),o=r(11),i=r.n(o),c=r(5),l=r(1),u=r.n(l),s=(r(155),function(e){var t=e.disabled,r=e.value,o=e.onChange,l=e.dateFormat,u=e.label,s=e.describedBy,f=e.error,p=e.onFocus,b=e.onKeyDown,d=e.errorPosition,y=i()("bwf-calendar-input",{"is-empty":0===r.length,"is-error":f}),m=Object(c.uniqueId)("_woo-dates-input");return Object(n.createElement)("div",{className:y},Object(n.createElement)("input",{type:"text",className:"bwf-calendar-input-text",value:r,onChange:o,"aria-label":u,id:m,"aria-describedby":"".concat(m,"-message"),placeholder:l.toLowerCase(),onFocus:p,onKeyDown:b,disabled:t}),f&&Object(n.createElement)(a.Popover,{className:"bwf-calendar-input-error",focusOnMount:!1,position:d},f),Object(n.createElement)(a.Dashicon,{icon:"calendar"}),Object(n.createElement)("p",{className:"screen-reader-text",id:"".concat(m,"-message")},f||s))});s.propTypes={disabled:u.a.bool,value:u.a.string,onChange:u.a.func.isRequired,dateFormat:u.a.string.isRequired,label:u.a.string.isRequired,describedBy:u.a.string.isRequired,error:u.a.string,errorPosition:u.a.string,onFocus:u.a.func,onKeyDown:u.a.func},s.defaultProps={disabled:!1,onFocus:function(){},errorPosition:"bottom center",onKeyDown:c.noop},t.a=s},155:function(e,t,r){},239:function(e,t,r){"use strict";var n=r(0),a=r(10),o=r(40),i=r(1),c=r.n(i),l=r(11),u=r.n(l);r(389);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=function(e){var t=e.labels,r=e.isOpen,i=f(e,["labels","isOpen"]),c=u()("bwf-dropdown-button",{"is-open":r,"is-multi-line":t.length>1});return Object(n.createElement)(a.Button,s({className:c,"aria-expanded":r},i),Object(n.createElement)("div",{className:"bwf-dropdown-button-labels"},t.map((function(e,t){return Object(n.createElement)("span",{key:t},Object(o.decodeEntities)(e))}))))};p.propTypes={labels:c.a.array.isRequired,isOpen:c.a.bool},t.a=p},242:function(e,t,r){"use strict";var n=r(0),a=r(11),o=r.n(a),i=r(5),c=r(1),l=r.n(c),u=r(50),s=r(101);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var a=v(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){var t=e.className;return Object(n.createElement)("li",{"data-testid":"summary-placeholder",className:o()("bwf-summary-item-container is-placeholder",t)},Object(n.createElement)("div",{className:"bwf-summary-item"},Object(n.createElement)("div",{className:"bwf-summary-item-label"}),Object(n.createElement)("div",{className:"bwf-summary-item-data"},Object(n.createElement)("div",{className:"bwf-summary-item-value"}),Object(n.createElement)("div",{className:"bwf-summary-item-delta"}))))},O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(l,e);var t,r,a,c=m(l);function l(){return b(this,l),c.apply(this,arguments)}return t=l,(r=[{key:"render",value:function(){var e,t=this.props.isDropdownBreakpoint,r=t?1:this.props.numberOfItems,a=Object(s.a)(r),c=o()("bwf-summary",(p(e={},a,!t),p(e,"is-placeholder",!0),e));return Object(n.createElement)("ul",{className:c,"aria-hidden":"true"},Object(i.range)(r).map((function(e){return Object(n.createElement)(g,{key:e})})))}}])&&d(t.prototype,r),a&&d(t,a),l}(n.Component);O.propTypes={numberOfItems:l.a.number.isRequired},O.defaultProps={numberOfRows:5},t.a=Object(u.withViewportMatch)({isDropdownBreakpoint:"< large"})(O)},243:function(e,t,r){"use strict";var n=r(0),a=r(3),o=r(10),i=r(1),c=r.n(i),l=r(11),u=r.n(l),s=r(9),f=r.n(s),p=r(29),b=r(5);r(276);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=j(e);if(t){var a=j(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return O(this,r)}}function O(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(i,e);var t,r,a,o=g(i);function i(){return m(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"render",value:function(){var e=this.props,t=e.className,r=e.options,a=e.selected,o=e.onSelect,i=e.name,c=e.legend;return Object(n.createElement)("fieldset",{className:"bwf-segment-selection"},Object(n.createElement)("legend",{className:"screen-reader-text"},c),Object(n.createElement)("div",{className:u()(t,"bwf-segment-selection-container")},r.map((function(e){var t=e.value,r=e.label;if(!t||!r)return null;var c=Object(b.uniqueId)("".concat(t,"_"));return Object(n.createElement)("div",{className:"bwf-segment-selection-item",key:t},Object(n.createElement)("input",{className:"bwf-segment-selection-input",type:"radio",name:i,id:c,checked:a===t,onChange:Object(b.partial)(o,y({},i,t))}),Object(n.createElement)("label",{htmlFor:c},Object(n.createElement)("span",{className:"bwf-segment-selection-label"},r)))}))))}}])&&h(t.prototype,r),a&&h(t,a),i}(n.Component);w.propTypes={className:c.a.string,options:c.a.arrayOf(c.a.shape({value:c.a.string.isRequired,label:c.a.string.isRequired})).isRequired,selected:c.a.string,onSelect:c.a.func.isRequired,name:c.a.string.isRequired,legend:c.a.string.isRequired};var S=w;function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P(e);if(t){var a=P(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return R(this,r)}}function R(e,t){return!t||"object"!==E(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(c,e);var t,r,o,i=C(c);function c(){return _(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"render",value:function(){var e=this.props,t=e.onSelect,r=e.compare;return Object(n.createElement)(S,{options:p.i,selected:r,onSelect:t,name:"compare",legend:Object(a.__)("compare to","funnel-builder")})}}])&&k(t.prototype,r),o&&k(t,o),c}(n.Component);x.propTypes={onSelect:c.a.func.isRequired,compare:c.a.string};var D=x,T=(r(252),r(253),r(248),r(241)),N=r(50),q=(r(155),r(133)),A={calendarLabel:Object(a.__)("Calendar","funnel-builder"),closeDatePicker:Object(a.__)("Close","funnel-builder"),focusStartDate:Object(a.__)("Interact with the calendar and select start and end dates.","funnel-builder"),clearDate:Object(a.__)("Clear Date","funnel-builder"),clearDates:Object(a.__)("Clear Dates","funnel-builder"),jumpToPrevMonth:Object(a.__)("Move backward to switch to the previous month.","funnel-builder"),jumpToNextMonth:Object(a.__)("Move forward to switch to the next month.","funnel-builder"),enterKey:Object(a.__)("Enter key","funnel-builder"),leftArrowRightArrow:Object(a.__)("Right and left arrow keys","funnel-builder"),upArrowDownArrow:Object(a.__)("up and down arrow keys","funnel-builder"),pageUpPageDown:Object(a.__)("page up and page down keys","funnel-builder"),homeEnd:Object(a.__)("Home and end keys","funnel-builder"),escape:Object(a.__)("Escape key","funnel-builder"),questionMark:Object(a.__)("Question mark","funnel-builder"),selectFocusedDate:Object(a.__)("Select the date in focus.","funnel-builder"),moveFocusByOneDay:Object(a.__)("Move backward (left) and forward (right) by one day.","funnel-builder"),moveFocusByOneWeek:Object(a.__)("Move backward (up) and forward (down) by one week.","funnel-builder"),moveFocusByOneMonth:Object(a.__)("Switch months.","funnel-builder"),moveFocustoStartAndEndOfWeek:Object(a.__)("Go to the first or last day of a week.","funnel-builder"),returnFocusToInput:Object(a.__)("Return to the date input field.","funnel-builder"),keyboardNavigationInstructions:Object(a.__)("Press the down arrow key to interact with the calendar and select a date.","funnel-builder"),chooseAvailableStartDate:function(e){var t=e.date;return Object(a.sprintf)(Object(a.__)("Select %s as a start date.","funnel-builder"),t)},chooseAvailableEndDate:function(e){var t=e.date;return Object(a.sprintf)(Object(a.__)("Select %s as an end date.","funnel-builder"),t)},chooseAvailableDate:function(e){return e.date},dateIsUnavailable:function(e){var t=e.date;return Object(a.sprintf)(Object(a.__)("%s is not selectable.","funnel-builder"),t)},dateIsSelected:function(e){var t=e.date;return Object(a.sprintf)(Object(a.__)("Selected. %s","funnel-builder"),t)}};function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Y(e);if(t){var a=Y(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return K(this,r)}}function K(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?U(e):t}function U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var H=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(c,e);var t,r,o,i=V(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=i.call(this,e)).onDatesChange=t.onDatesChange.bind(U(t)),t.onFocusChange=t.onFocusChange.bind(U(t)),t.onInputChange=t.onInputChange.bind(U(t)),t.nodeRef=Object(n.createRef)(),t.keepFocusInside=t.keepFocusInside.bind(U(t)),t}return t=c,(r=[{key:"keepFocusInside",value:function(e,t){if(this.nodeRef.current){var r=this.props.losesFocusTo;if("container"!==e||!t.target||!t.target.classList.contains("DayPickerNavigation_button")&&!t.target.classList.contains("CalendarDay")||t.relatedTarget&&(t.relatedTarget.classList.contains("DayPickerNavigation_button")||t.relatedTarget.classList.contains("CalendarDay"))){if("onPrevMonthClick"===e||"onNextMonthClick"===e){var n=this.nodeRef.current.querySelector(".DayPickerNavigation_button");n&&n.focus()}}else{if(t.relatedTarget&&(t.relatedTarget.classList.contains("DayPickerNavigation_button")||t.relatedTarget.classList.contains("CalendarDay")))return;if(t.relatedTarget&&r&&r.contains(t.relatedTarget))return;var a=this.nodeRef.current.querySelector(".DayPicker_focusRegion");a&&a.focus()}}}},{key:"onDatesChange",value:function(e){var t=e.startDate,r=e.endDate,n=this.props,a=n.onUpdate,o=n.shortDateFormat;a({after:t,before:r,afterText:t?t.format(o):"",beforeText:r?r.format(o):"",afterError:null,beforeError:null})}},{key:"onFocusChange",value:function(e){this.props.onUpdate({focusedInput:e||"startDate"})}},{key:"onInputChange",value:function(e,t){var r,n=t.target.value,a=this.props,o=a.after,i=a.before,c=a.shortDateFormat,l=Object(p.l)(e,n,i,o,c),u=l.date,s=l.error;this.props.onUpdate((M(r={},e,u),M(r,e+"Text",n),M(r,e+"Error",n.length>0?s:null),r))}},{key:"setTnitialVisibleMonth",value:function(e,t){return function(){var r=t||f()();return e?r.clone().subtract(1,"month"):r}}},{key:"render",value:function(){var e=this,t=this.props,r=t.after,o=t.before,i=t.focusedInput,c=t.afterText,l=t.beforeText,s=t.afterError,f=t.beforeError,p=t.shortDateFormat,d=t.isViewportMobile,y=t.isViewportSmall,m=t.isInvalidDate,h=d&&!y;return Object(n.createElement)("div",{className:u()("bwf-calendar",{"is-mobile":d})},Object(n.createElement)("div",{className:"bwf-calendar-inputs"},Object(n.createElement)(q.a,{value:c,onChange:Object(b.partial)(this.onInputChange,"after"),dateFormat:p,label:Object(a.__)("Start Date","funnel-builder"),error:s,describedBy:Object(a.sprintf)(Object(a.__)("Date input describing a selected date range's start date in format %s","funnel-builder"),p),onFocus:function(){return e.onFocusChange("startDate")}}),Object(n.createElement)("div",{className:"bwf-calendar-inputs-to"},Object(a.__)("to","funnel-builder")),Object(n.createElement)(q.a,{value:l,onChange:Object(b.partial)(this.onInputChange,"before"),dateFormat:p,label:Object(a.__)("End Date","funnel-builder"),error:f,describedBy:Object(a.sprintf)(Object(a.__)("Date input describing a selected date range's end date in format %s","funnel-builder"),p),onFocus:function(){return e.onFocusChange("endDate")}})),Object(n.createElement)("div",{className:"bwf-calendar-react-dates",ref:this.nodeRef,onBlur:Object(b.partial)(this.keepFocusInside,"container"),tabIndex:-1},Object(n.createElement)(T.DayPickerRangeController,{onNextMonthClick:Object(b.partial)(this.keepFocusInside,"onNextMonthClick"),onPrevMonthClick:Object(b.partial)(this.keepFocusInside,"onPrevMonthClick"),onDatesChange:this.onDatesChange,onFocusChange:this.onFocusChange,focusedInput:i,startDate:r,endDate:o,orientation:"horizontal",numberOfMonths:h?2:1,isOutsideRange:function(e){return m&&m(e.toDate())},minimumNights:0,hideKeyboardShortcutsPanel:!0,noBorder:!0,isRTL:"rtl"===document.documentElement.dir,initialVisibleMonth:this.setTnitialVisibleMonth(h,o),phrases:A})))}}])&&L(t.prototype,r),o&&L(t,o),c}(n.Component);H.propTypes={after:c.a.object,afterError:c.a.string,afterText:c.a.string,before:c.a.object,beforeError:c.a.string,beforeText:c.a.string,focusedInput:c.a.string,isInvalidDate:c.a.func,onUpdate:c.a.func.isRequired,shortDateFormat:c.a.string.isRequired,losesFocusTo:c.a.instanceOf(Element)};var Q=Object(N.withViewportMatch)({isViewportMobile:"< medium",isViewportSmall:"< small"})(H),z=r(26);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ee(e);if(t){var a=ee(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Z(this,r)}}function Z(e,t){return!t||"object"!==$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(c,e);var t,r,o,i=X(c);function c(){return W(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"render",value:function(){var e=this.props,t=e.onSelect,r=e.period;return Object(n.createElement)(S,{options:Object(b.filter)(p.j,(function(e){return"custom"!==e.value})),selected:r,onSelect:t,name:"period",legend:Object(a.__)("select a preset period","funnel-builder")})}}])&&G(t.prototype,r),o&&G(t,o),c}(n.Component);te.propTypes={onSelect:c.a.func.isRequired,period:c.a.string};var re=te;function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oe(e,t){return(oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ue(e);if(t){var a=ue(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return ce(this,r)}}function ce(e,t){return!t||"object"!==ne(t)&&"function"!=typeof t?le(e):t}function le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oe(e,t)}(l,e);var t,r,i,c=ie(l);function l(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(e=c.call(this)).onTabSelect=e.onTabSelect.bind(le(e)),e.controlsRef=Object(n.createRef)(),e}return t=l,(r=[{key:"onTabSelect",value:function(e){var t=this.props,r=t.onUpdate,n=t.period;"period"===e&&"custom"===n&&r({period:"today"})}},{key:"isFutureDate",value:function(e){return f()().isBefore(f()(e),"day")}},{key:"render",value:function(){var e=this,t=this.props,r=t.period,i=t.compare,c=t.after,l=t.before,s=t.onUpdate,f=t.onClose,p=t.onSelect,b=t.isValidSelection,d=t.resetCustomValues,y=t.focusedInput,m=t.afterText,h=t.beforeText,v=t.afterError,g=t.beforeError,O=t.shortDateFormat;return Object(n.createElement)("div",null,Object(n.createElement)(z.a,{className:"screen-reader-text",tabIndex:"0"},Object(a.__)("Select date range and comparison","funnel-builder")),Object(n.createElement)(z.b,{component:!1},Object(n.createElement)(z.a,{className:"bwf-filters-date-text"},Object(a.__)("select a date range","funnel-builder")),Object(n.createElement)(o.TabPanel,{tabs:[{name:"period",title:Object(a.__)("Presets","funnel-builder"),className:"bwf-filters-date-tab"},{name:"custom",title:Object(a.__)("Custom","funnel-builder"),className:"bwf-filters-date-tab"}],className:"bwf-filters-date-tabs",activeClass:"is-active",initialTabName:"custom"===r?"custom":"period",onSelect:this.onTabSelect},(function(t){return Object(n.createElement)(n.Fragment,null,"period"===t.name&&Object(n.createElement)(re,{onSelect:s,period:r}),"custom"===t.name&&Object(n.createElement)(Q,{after:c,before:l,onUpdate:s,isInvalidDate:e.isFutureDate,focusedInput:y,afterText:m,beforeText:h,afterError:v,beforeError:g,shortDateFormat:O,losesFocusTo:e.controlsRef.current}),Object(n.createElement)("div",{className:u()("bwf-filters-date-content-controls",{"is-custom":"custom"===t.name}),ref:e.controlsRef},Object(n.createElement)(z.a,{className:"bwf-filters-date-text"},Object(a.__)("compare to","funnel-builder")),Object(n.createElement)(D,{onSelect:s,compare:i}),Object(n.createElement)("div",{className:"bwf-filters-date-button-group"},"custom"===t.name&&Object(n.createElement)(o.Button,{className:"bwf-filters-date-button",isSecondary:!0,onClick:d,disabled:!(c||l)},Object(a.__)("Reset","funnel-builder")),b(t.name)?Object(n.createElement)(o.Button,{className:"bwf-filters-date-button",onClick:p(t.name,f),isPrimary:!0},Object(a.__)("Update","funnel-builder")):Object(n.createElement)(o.Button,{className:"bwf-filters-date-button",isPrimary:!0,disabled:!0},Object(a.__)("Update","funnel-builder")))))}))))}}])&&ae(t.prototype,r),i&&ae(t,i),l}(n.Component);se.propTypes={period:c.a.string.isRequired,compare:c.a.string.isRequired,onUpdate:c.a.func.isRequired,onClose:c.a.func.isRequired,onSelect:c.a.func.isRequired,resetCustomValues:c.a.func.isRequired,focusedInput:c.a.string,afterText:c.a.string,beforeText:c.a.string,afterError:c.a.string,beforeError:c.a.string,shortDateFormat:c.a.string.isRequired};var fe=se,pe=r(239);r(390);function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ge(e);if(t){var a=ge(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return he(this,r)}}function he(e,t){return!t||"object"!==be(t)&&"function"!=typeof t?ve(e):t}function ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Oe=Object(a.__)("MM/DD/YYYY","funnel-builder"),je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(l,e);var t,r,i,c=me(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=c.call(this,e)).state=t.getResetState(),t.update=t.update.bind(ve(t)),t.onSelect=t.onSelect.bind(ve(t)),t.isValidSelection=t.isValidSelection.bind(ve(t)),t.resetCustomValues=t.resetCustomValues.bind(ve(t)),t}return t=l,(r=[{key:"formatDate",value:function(e,t){return e&&e._isAMomentObject&&"function"==typeof e.format?e.format(t):""}},{key:"getResetState",value:function(){var e=this.props.dateQuery,t=e.period,r=e.compare,n=e.before,a=e.after;return{period:t,compare:r,before:n,after:a,focusedInput:"startDate",afterText:this.formatDate(a,Oe),beforeText:this.formatDate(n,Oe),afterError:null,beforeError:null}}},{key:"update",value:function(e){this.setState(e)}},{key:"onSelect",value:function(e,t){var r=this,n=this.props,a=n.isoDateFormat,o=n.onRangeSelect;return function(n){var i=r.state,c=i.period,l=i.compare,u=i.after,s=i.before,f={period:"custom"===e?"custom":c,compare:l};"custom"===e?(f.after=r.formatDate(u,a),f.before=r.formatDate(s,a)):(f.after=void 0,f.before=void 0),o(f),t(n)}}},{key:"getButtonLabel",value:function(){var e=this.props.dateQuery,t=e.primaryDate,r=e.secondaryDate;return["".concat(t.label," (").concat(t.range,")"),"".concat(Object(a.__)("vs.","funnel-builder")," ").concat(r.label," (").concat(r.range,")")]}},{key:"isValidSelection",value:function(e){var t=this.state,r=t.compare,n=t.after,a=t.before;return"custom"!==e||r&&n&&a}},{key:"resetCustomValues",value:function(){this.setState({after:null,before:null,focusedInput:"startDate",afterText:"",beforeText:"",afterError:null,beforeError:null})}},{key:"render",value:function(){var e=this,t=this.state,r=t.period,i=t.compare,c=t.after,l=t.before,u=t.focusedInput,s=t.afterText,f=t.beforeText,p=t.afterError,b=t.beforeError;return Object(n.createElement)("div",{className:"bwf-filters-filter"},Object(n.createElement)("span",{className:"bwf-filters-label"},Object(a.__)("Date Range","funnel-builder"),":"),Object(n.createElement)(o.Dropdown,{contentClassName:"bwf-filters-date-content",position:"bottom",expandOnMobile:!0,renderToggle:function(t){var r=t.isOpen,a=t.onToggle;return Object(n.createElement)(pe.a,{onClick:a,isOpen:r,labels:e.getButtonLabel()})},renderContent:function(t){var a=t.onClose;return Object(n.createElement)(fe,{period:r,compare:i,after:c,before:l,onUpdate:e.update,onClose:a,onSelect:e.onSelect,isValidSelection:e.isValidSelection,resetCustomValues:e.resetCustomValues,focusedInput:u,afterText:s,beforeText:f,afterError:p,beforeError:b,shortDateFormat:Oe})}}))}}])&&de(t.prototype,r),i&&de(t,i),l}(n.Component);je.propTypes={onRangeSelect:c.a.func.isRequired,dateQuery:c.a.shape({period:c.a.string.isRequired,compare:c.a.string.isRequired,before:c.a.object,after:c.a.object,primaryDate:c.a.shape({label:c.a.string.isRequired,range:c.a.string.isRequired}).isRequired,secondaryDate:c.a.shape({label:c.a.string.isRequired,range:c.a.string.isRequired}).isRequired}).isRequired};t.a=je},244:function(e,t,r){"use strict";var n=r(0),a=r(3),o=r(10),i=r(1),c=r.n(i),l=r(50),u=r(11),s=r.n(u),f=r(5),p=r(101);var b=function(e){var t,r,i,c=e.label,l=e.orientation,u=e.itemCount,b=e.items,d=Object(f.uniqueId)("bwf-summary-helptext-"),y=Object(p.a)(u),m=s()("bwf-summary",(i="horizontal"===l,(r=y)in(t={})?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t));return Object(n.createElement)(o.NavigableMenu,{"aria-label":c,"aria-describedby":d,orientation:l,stopNavigationEvents:!0},Object(n.createElement)("p",{id:d,className:"screen-reader-text"},Object(a.__)("List of data points available for filtering. Use arrow keys to cycle through the list. Click a data point for a detailed report.","funnel-builder")),Object(n.createElement)("ul",{className:m},b))};b.propTypes={label:c.a.string,orientation:c.a.oneOf(["vertical","horizontal"]).isRequired,items:c.a.node.isRequired,itemCount:c.a.number.isRequired};var d=b,y=(r(392),function(e){var t=e.children,r=e.isDropdownBreakpoint,a=e.label,i=t({}),c=n.Children.count(i)||1,l=r?"vertical":"horizontal",u=Object(n.createElement)(d,{label:a,orientation:l,itemCount:c,items:i});if(!r||c<2)return u;var s=i.find((function(e){return!!e.props.selected}));return s?Object(n.createElement)(o.Dropdown,{className:"bwf-summary",position:"bottom",headerTitle:a,renderToggle:function(e){var t=e.isOpen,r=e.onToggle;return Object(n.cloneElement)(s,{onToggle:r,isOpen:t})},renderContent:function(e){return Object(n.createElement)(d,{label:a,orientation:l,itemCount:c,items:t(e)})}}):u});y.propTypes={children:c.a.func.isRequired,label:c.a.string},y.defaultProps={label:Object(a.__)("Performance Indicators","funnel-builder")};t.a=Object(l.withViewportMatch)({isDropdownBreakpoint:"< large"})(y)},276:function(e,t,r){},319:function(e,t){},389:function(e,t,r){},390:function(e,t,r){},391:function(e,t,r){},392:function(e,t,r){},439:function(e,t,r){"use strict";r.d(t,"b",(function(){return lr})),r.d(t,"e",(function(){return yr})),r.d(t,"a",(function(){return Gn})),r.d(t,"d",(function(){return na})),r.d(t,"c",(function(){return oa}));var n=r(0),a=r(3),o=r(5),i=r(1),c=r.n(i),l=r(33),u=r(29),s=r(79),f=r(10),p=r(235),b=r.n(p),d=r(412),y=r.n(d),m=r(11),h=r.n(m),v=r(237),g=r(236);function O(e){var t="";return function e(r){if(Object(o.isString)(r)||Object(o.isNumber)(r))t+=r;else if(Object(o.isArray)(r))r.forEach(e);else if(r&&r.props){var n=r.props.children;Object(o.isArray)(n)?n.forEach(e):e(n)}}(e),t}function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=C(e);if(t){var a=C(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return k(this,r)}}function k(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?F(e):t}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(c,e);var t,r,a,i=_(c);function c(e){var t,r=e.filter,n=e.config,a=e.onFilterChange;w(this,c),t=i.apply(this,arguments);var o=n.input.options;return t.state={options:o},t.updateOptions=t.updateOptions.bind(F(t)),!o&&n.input.getOptions&&n.input.getOptions().then(t.updateOptions).then((function(e){if(!r.value){var t=Object(l.c)(n,e);a(r.key,"value",t)}})),t}return t=c,(r=[{key:"updateOptions",value:function(e){return this.setState({options:e}),e}},{key:"getScreenReaderText",value:function(e,t){if(""===e.value)return"";var r=Object(o.find)(t.rules,{value:e.rule})||{},a=Object(o.find)(t.input.options,{value:e.value})||{};return O(y()({mixedString:t.labels.title,components:{filter:Object(n.createElement)(n.Fragment,null,a.label),rule:Object(n.createElement)(n.Fragment,null,r.label),title:Object(n.createElement)(n.Fragment,null)}}))}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.config,a=e.filter,i=e.onFilterChange,c=e.isEnglish,l=this.state.options,u=a.key,s=a.rule,p=a.value,b=r.labels,d=r.rules,m=y()({mixedString:b.title,components:{title:Object(n.createElement)("span",{className:t}),rule:Object(n.createElement)(f.SelectControl,{className:h()(t,"bwf-filters-advanced-rule"),options:d,value:s,onChange:Object(o.partial)(i,u,"rule"),"aria-label":b.rule}),filter:l?Object(n.createElement)(f.SelectControl,{className:h()(t,"bwf-filters-advanced-input"),options:l,value:p,onChange:Object(o.partial)(i,a.key,"value"),"aria-label":b.filter}):Object(n.createElement)(f.Spinner,null)}}),v=this.getScreenReaderText(a,r);return Object(n.createElement)("fieldset",{className:"bwf-filters-advanced-line-item",tabIndex:"0"},Object(n.createElement)("legend",{className:"screen-reader-text"},b.add||""),Object(n.createElement)("div",{className:h()("bwf-filters-advanced-fieldset",{"is-english":c})},m),v&&Object(n.createElement)("span",{className:"screen-reader-text"},v))}}])&&S(t.prototype,r),a&&S(t,a),c}(n.Component);R.propTypes={config:c.a.shape({labels:c.a.shape({rule:c.a.string,title:c.a.string,filter:c.a.string}),rules:c.a.arrayOf(c.a.object),input:c.a.object}).isRequired,filter:c.a.shape({key:c.a.string,rule:c.a.string,value:c.a.string}).isRequired,onFilterChange:c.a.func.isRequired};var P=R,x=r(417);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=K(e);if(t){var a=K(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return B(this,r)}}function B(e,t){return!t||"object"!==D(t)&&"function"!=typeof t?V(e):t}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(c,e);var t,r,a,i=L(c);function c(e){var t,r=e.filter,n=e.config,a=e.query;return A(this,c),(t=i.apply(this,arguments)).onSearchChange=t.onSearchChange.bind(V(t)),t.state={selected:[]},t.updateLabels=t.updateLabels.bind(V(t)),r.value.length&&n.input.getLabels(r.value,a).then((function(e){var r=e.map((function(e){return N({key:e.id},e)}));t.updateLabels(r)})),t}return t=c,(r=[{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.config,n=t.filter,a=t.query,i=e.filter;if(n.value.length&&!Object(o.isEqual)(i,n)){var c=this.state.selected.map((function(e){return e.key}));Object(l.e)(n.value).every((function(e){return!c.includes(e)}))&&r.input.getLabels(n.value,a).then(this.updateLabels)}}},{key:"updateLabels",value:function(e){var t=this.state.selected.map((function(e){return e.key})),r=e.map((function(e){return e.key}));Object(o.isEqual)(r.sort(),t.sort())||this.setState({selected:e})}},{key:"onSearchChange",value:function(e){this.setState({selected:e});var t=this.props,r=t.filter,n=t.onFilterChange,a=e.map((function(e){return e.key})).join(",");n(r.key,"value",a)}},{key:"getScreenReaderText",value:function(e,t){var r=this.state.selected;if(0===r.length)return"";var a=Object(o.find)(t.rules,{value:e.rule})||{},i=r.map((function(e){return e.label})).join(", ");return O(y()({mixedString:t.labels.title,components:{filter:Object(n.createElement)(n.Fragment,null,i),rule:Object(n.createElement)(n.Fragment,null,a.label),title:Object(n.createElement)(n.Fragment,null)}}))}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.config,a=e.filter,i=e.onFilterChange,c=e.isEnglish,l=this.state.selected,u=a.key,s=a.rule,p=r.input,b=r.labels,d=r.rules,m=y()({mixedString:b.title,components:{title:Object(n.createElement)("span",{className:t}),rule:Object(n.createElement)(f.SelectControl,{className:h()(t,"bwf-filters-advanced-rule"),options:d,value:s,onChange:Object(o.partial)(i,u,"rule"),"aria-label":b.rule}),filter:Object(n.createElement)(x.a,{className:h()(t,"bwf-filters-advanced-input"),onChange:this.onSearchChange,type:p.type,placeholder:b.placeholder,selected:l,inlineTags:!0,"aria-label":b.filter})}}),v=this.getScreenReaderText(a,r);return Object(n.createElement)("fieldset",{className:"bwf-filters-advanced-line-item",tabIndex:"0"},Object(n.createElement)("legend",{className:"screen-reader-text"},b.add||""),Object(n.createElement)("div",{className:h()("bwf-filters-advanced-fieldset",{"is-english":c})},m),v&&Object(n.createElement)("span",{className:"screen-reader-text"},v))}}])&&I(t.prototype,r),a&&I(t,a),c}(n.Component);U.propTypes={config:c.a.shape({labels:c.a.shape({placeholder:c.a.string,rule:c.a.string,title:c.a.string}),rules:c.a.arrayOf(c.a.object),input:c.a.object}).isRequired,filter:c.a.shape({key:c.a.string,rule:c.a.string,value:c.a.string}).isRequired,onFilterChange:c.a.func.isRequired,query:c.a.object};var Y=U,H=r(131);r(507);function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function $(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Z(e);if(t){var a=Z(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return X(this,r)}}function X(e,t){return!t||"object"!==Q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(i,e);var t,r,a,o=J(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={isFocused:!1},t}return t=i,(r=[{key:"handleFocusOutside",value:function(){this.setState({isFocused:!1})}},{key:"handleOnClick",value:function(e,t){this.setState({isFocused:!0}),"function"==typeof t&&t(e)}},{key:"render",value:function(){var e=this,t=this.props,r=t.label,a=t.value,o=t.help,i=t.className,c=t.instanceId,l=t.onChange,u=t.onClick,s=t.prefix,p=t.suffix,b=t.type,d=t.disabled,y=$(t,["label","value","help","className","instanceId","onChange","onClick","prefix","suffix","type","disabled"]),m=this.state.isFocused,v="inspector-text-control-with-affixes-".concat(c),g=[];o&&g.push("".concat(v,"__help")),s&&g.push("".concat(v,"__prefix")),p&&g.push("".concat(v,"__suffix"));var O=h()(i,{"with-value":""!==a,empty:""===a,active:m&&!d}),j=h()("text-control-with-affixes",{"text-control-with-prefix":s,"text-control-with-suffix":p,disabled:d});return Object(n.createElement)(f.BaseControl,{label:r,id:v,help:o,className:O,onClick:function(t){return e.handleOnClick(t,u)}},Object(n.createElement)("div",{className:j},s&&Object(n.createElement)("span",{id:"".concat(v,"__prefix"),className:"text-control-with-affixes__prefix"},s),Object(n.createElement)("input",z({className:"components-text-control__input",type:b,id:v,value:a,onChange:function(e){return l(e.target.value)},"aria-describedby":g.join(" "),disabled:d,onFocus:function(){return e.setState({isFocused:!0})}},y)),p&&Object(n.createElement)("span",{id:"".concat(v,"__suffix"),className:"text-control-with-affixes__suffix"},p)))}}])&&W(t.prototype,r),a&&W(t,a),i}(n.Component);ee.defaultProps={type:"text"},ee.propTypes={label:c.a.string,help:c.a.string,type:c.a.string,value:c.a.string.isRequired,className:c.a.string,onChange:c.a.func.isRequired,prefix:c.a.node,suffix:c.a.node,disabled:c.a.bool};var te=Object(H.compose)([H.withInstanceId,f.withFocusOutside])(ee);function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=se(e);if(t){var a=se(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return ue(this,r)}}function ue(e,t){return!t||"object"!==re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(l,e);var t,r,i,c=le(l);function l(){return oe(this,l),c.apply(this,arguments)}return t=l,(r=[{key:"getBetweenString",value:function(){return Object(a._x)("{{rangeStart /}}{{span}} and {{/span}}{{rangeEnd /}}","Numerical range inputs arranged on a single line","funnel-builder")}},{key:"getScreenReaderText",value:function(e,t){var r=this.props.currency,a=Object(o.find)(t.rules,{value:e.rule})||{},i=ne(Object(o.isArray)(e.value)?e.value:[e.value],2),c=i[0],l=i[1];if(!c||"between"===a.value&&!l)return"";if("currency"===Object(o.get)(t,["input","type"],"number")){var u=Object(s.a)(r).formatAmount;c=u(c),l=u(l)}var f=c;return"between"===a.value&&(f=y()({mixedString:this.getBetweenString(),components:{rangeStart:Object(n.createElement)(n.Fragment,null,c),rangeEnd:Object(n.createElement)(n.Fragment,null,l),span:Object(n.createElement)(n.Fragment,null)}})),O(y()({mixedString:t.labels.title,components:{filter:Object(n.createElement)(n.Fragment,null,f),rule:Object(n.createElement)(n.Fragment,null,a.label),title:Object(n.createElement)(n.Fragment,null)}}))}},{key:"getFormControl",value:function(e){var t=e.type,r=e.value,a=e.label,o=e.onChange,i=e.currencySymbol,c=e.symbolPosition;return"currency"===t?0===c.indexOf("right")?Object(n.createElement)(te,{suffix:Object(n.createElement)("span",{dangerouslySetInnerHTML:{__html:i}}),className:"bwf-filters-advanced-input",type:"number",value:r||"","aria-label":a,onChange:o}):Object(n.createElement)(te,{prefix:Object(n.createElement)("span",{dangerouslySetInnerHTML:{__html:i}}),className:"bwf-filters-advanced-input",type:"number",value:r||"","aria-label":a,onChange:o}):Object(n.createElement)(f.TextControl,{className:"bwf-filters-advanced-input",type:"number",value:r||"","aria-label":a,onChange:o})}},{key:"getFilterInputs",value:function(){var e=this.props,t=e.config,r=e.filter,n=e.onFilterChange,i=e.currency,c=i.symbol,l=i.symbolPosition;if("between"===r.rule)return this.getRangeInput();var u=Object(o.get)(t,["input","type"],"number"),s=ne(Object(o.isArray)(r.value)?r.value:[r.value],2),f=s[0],p=s[1];Boolean(p)&&n(r.key,"value",f||p);var b="";
/* translators: Sentence fragment, "maximum amount" refers to a numeric value the field must be less than. Screenshot for context: https://cloudup.com/cmv5CLyMPNQ */
return b="lessthan"===r.rule?Object(a._x)("%(field)s maximum amount","maximum value input","funnel-builder"):Object(a._x)("%(field)s minimum amount","minimum value input","funnel-builder"),this.getFormControl({type:u,value:f||p,label:Object(a.sprintf)(b,{field:Object(o.get)(t,["labels","add"])}),onChange:Object(o.partial)(n,r.key,"value"),currencySymbol:c,symbolPosition:l})}},{key:"getRangeInput",value:function(){var e=this.props,t=e.config,r=e.filter,i=e.onFilterChange,c=e.currency,l=c.symbol,u=c.symbolPosition,s=Object(o.get)(t,["input","type"],"number"),f=ne(Object(o.isArray)(r.value)?r.value:[r.value],2),p=f[0],b=f[1];return y()({mixedString:this.getBetweenString(),components:{rangeStart:this.getFormControl({type:s,value:p||"",label:Object(a.sprintf)(
/* translators: Sentence fragment, "range start" refers to the first of two numeric values the field must be between. Screenshot for context: https://cloudup.com/cmv5CLyMPNQ */
Object(a.__)("%(field)s range start","funnel-builder"),{field:Object(o.get)(t,["labels","add"])}),onChange:function(e){i(r.key,"value",[e,b])},currencySymbol:l,symbolPosition:u}),rangeEnd:this.getFormControl({type:s,value:b||"",label:Object(a.sprintf)(
/* translators: Sentence fragment, "range end" refers to the second of two numeric values the field must be between. Screenshot for context: https://cloudup.com/cmv5CLyMPNQ */
Object(a.__)("%(field)s range end","funnel-builder"),{field:Object(o.get)(t,["labels","add"])}),onChange:function(e){i(r.key,"value",[p,e])},currencySymbol:l,symbolPosition:u}),span:Object(n.createElement)("span",{className:"separator"})}})}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.config,a=e.filter,i=e.onFilterChange,c=e.isEnglish,l=a.key,u=a.rule,s=r.labels,p=r.rules,b=y()({mixedString:s.title,components:{title:Object(n.createElement)("span",{className:t}),rule:Object(n.createElement)(f.SelectControl,{className:h()(t,"bwf-filters-advanced-rule"),options:p,value:u,onChange:Object(o.partial)(i,l,"rule"),"aria-label":s.rule}),filter:Object(n.createElement)("div",{className:h()(t,"bwf-filters-advanced-input-range",{"is-between":"between"===u})},this.getFilterInputs())}}),d=this.getScreenReaderText(a,r);return Object(n.createElement)("fieldset",{className:"bwf-filters-advanced-line-item",tabIndex:"0"},Object(n.createElement)("legend",{className:"screen-reader-text"},s.add||""),Object(n.createElement)("div",{className:h()("bwf-filters-advanced-fieldset",{"is-english":c})},b),d&&Object(n.createElement)("span",{className:"screen-reader-text"},d))}}])&&ie(t.prototype,r),i&&ie(t,i),l}(n.Component),pe=r(9),be=r.n(pe),de=(r(252),r(253),r(67)),ye=(r(155),r(133)),me=r(26);function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Se(e);if(t){var a=Se(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return je(this,r)}}function je(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?we(e):t}function we(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}(l,e);var t,r,i,c=Oe(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=c.call(this,e)).onDateChange=t.onDateChange.bind(we(t)),t.onInputChange=t.onInputChange.bind(we(t)),t}return t=l,(r=[{key:"handleKeyDown",value:function(e,t,r){var n=r.keyCode;de.TAB===n&&e&&t()}},{key:"handleFocus",value:function(e,t){e||t()}},{key:"onDateChange",value:function(e,t){var r=this.props,n=r.onUpdate,a=r.dateFormat,o=be()(t);n({date:o,text:t?o.format(a):"",error:null}),e()}},{key:"onInputChange",value:function(e){var t=e.target.value,r=this.props.dateFormat,n=Object(u.k)(r,t),a=n?null:u.b.invalid;this.props.onUpdate({date:n,text:t,error:t.length>0?a:null})}},{key:"render",value:function(){var e=this,t=this.props,r=t.date,i=t.disabled,c=t.text,l=t.dateFormat,u=t.error,s=t.isInvalidDate;return Object(n.createElement)(f.Dropdown,{position:"bottom center",focusOnMount:!1,renderToggle:function(t){var r=t.isOpen,s=t.onToggle;return Object(n.createElement)(ye.a,{disabled:i,value:c,onChange:e.onInputChange,dateFormat:l,label:Object(a.__)("Choose a date","funnel-builder"),error:u,describedBy:Object(a.sprintf)(Object(a.__)("Date input describing a selected date in format %s","funnel-builder"),l),onFocus:Object(o.partial)(e.handleFocus,r,s),"aria-expanded":r,focusOnMount:!1,onKeyDown:Object(o.partial)(e.handleKeyDown,r,s),errorPosition:"top center"})},renderContent:function(t){var i=t.onToggle;return Object(n.createElement)(me.b,{component:!1},Object(n.createElement)(me.a,{className:"bwf-calendar-date-picker-title"},Object(a.__)("select a date","funnel-builder")),Object(n.createElement)("div",{className:"bwf-calendar-react-dates is-core-datepicker"},Object(n.createElement)(f.DatePicker,{currentDate:r,onChange:Object(o.partial)(e.onDateChange,i),isInvalidDate:s})))}})}}])&&ve(t.prototype,r),i&&ve(t,i),l}(n.Component);Ee.propTypes={date:c.a.object,disabled:c.a.bool,text:c.a.string,error:c.a.string,onUpdate:c.a.func.isRequired,dateFormat:c.a.string.isRequired,isInvalidDate:c.a.func};var _e=Ee;function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Re(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function De(e,t){return(De=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ae(e);if(t){var a=Ae(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Ne(this,r)}}function Ne(e,t){return!t||"object"!==ke(t)&&"function"!=typeof t?qe(e):t}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ie=Object(a.__)("MMM D, YYYY","funnel-builder"),Me=Object(a.__)("MM/DD/YYYY","funnel-builder"),Le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&De(e,t)}(l,e);var t,r,i,c=Te(l);function l(e){var t,r=e.filter;Pe(this,l),t=c.apply(this,arguments);var n=Array.isArray(r.value)?r.value:[null,r.value],a=Ce(n,2),o=a[0],i=a[1],s=o?Object(u.k)(u.h,o):null,f=i?Object(u.k)(u.h,i):null;return t.state={before:f,beforeText:f?f.format(Me):"",beforeError:null,after:s,afterText:s?s.format(Me):"",afterError:null},t.onSingleDateChange=t.onSingleDateChange.bind(qe(t)),t.onRangeDateChange=t.onRangeDateChange.bind(qe(t)),t.onRuleChange=t.onRuleChange.bind(qe(t)),t}return t=l,(r=[{key:"getBetweenString",value:function(){return Object(a._x)("{{after /}}{{span}} and {{/span}}{{before /}}","Date range inputs arranged on a single line","funnel-builder")}},{key:"getScreenReaderText",value:function(e,t){var r=Object(o.find)(t.rules,{value:e.rule})||{},a=this.state,i=a.before,c=a.after;if(!i||"between"===r.value&&!c)return"";var l=i.format(Ie);return"between"===r.value&&(l=y()({mixedString:this.getBetweenString(),components:{after:Object(n.createElement)(n.Fragment,null,c.format(Ie)),before:Object(n.createElement)(n.Fragment,null,i.format(Ie)),span:Object(n.createElement)(n.Fragment,null)}})),O(y()({mixedString:t.labels.title,components:{filter:Object(n.createElement)(n.Fragment,null,l),rule:Object(n.createElement)(n.Fragment,null,r.label),title:Object(n.createElement)(n.Fragment,null)}}))}},{key:"onSingleDateChange",value:function(e){var t=e.date,r=e.text,n=e.error,a=this.props,o=a.filter,i=a.onFilterChange;this.setState({before:t,beforeText:r,beforeError:n}),t&&i(o.key,"value",t.format(u.h))}},{key:"onRangeDateChange",value:function(e,t){var r,n=t.date,a=t.text,o=t.error,i=this.props,c=i.filter,l=i.onFilterChange;if(this.setState((Fe(r={},e,n),Fe(r,e+"Text",a),Fe(r,e+"Error",o),r)),n){var s=this.state,f=s.before,p=s.after,b=null,d=null;"after"===e&&(b=n.format(u.h),d=f?f.format(u.h):null),"before"===e&&(b=p?p.format(u.h):null,d=n.format(u.h)),b&&d&&l(c.key,"value",[b,d])}}},{key:"isFutureDate",value:function(e){return be()().isBefore(be()(e),"day")}},{key:"getFilterInputs",value:function(){var e=this.props.filter,t=this.state,r=t.before,a=t.beforeText,i=t.beforeError,c=t.after,l=t.afterText,u=t.afterError;return"between"===e.rule?y()({mixedString:this.getBetweenString(),components:{after:Object(n.createElement)(_e,{date:c,text:l,error:u,onUpdate:Object(o.partial)(this.onRangeDateChange,"after"),dateFormat:Me,isInvalidDate:this.isFutureDate}),before:Object(n.createElement)(_e,{date:r,text:a,error:i,onUpdate:Object(o.partial)(this.onRangeDateChange,"before"),dateFormat:Me,isInvalidDate:this.isFutureDate}),span:Object(n.createElement)("span",{className:"separator"})}}):Object(n.createElement)(_e,{date:r,text:a,error:i,onUpdate:this.onSingleDateChange,dateFormat:Me,isInvalidDate:this.isFutureDate})}},{key:"onRuleChange",value:function(e){var t=this.props,r=t.onFilterChange,n=t.filter,a=t.updateFilter,o=this.state.before;"between"===n.rule&&"between"!==e?a({key:n.key,rule:e,value:o?o.format(u.h):void 0}):r(n.key,"rule",e)}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.config,a=e.filter,o=e.isEnglish,i=a.rule,c=r.labels,l=r.rules,u=this.getScreenReaderText(a,r),s=y()({mixedString:c.title,components:{title:Object(n.createElement)("span",{className:t}),rule:Object(n.createElement)(f.SelectControl,{className:h()(t,"bwf-filters-advanced-rule"),options:l,value:i,onChange:this.onRuleChange,"aria-label":c.rule}),filter:Object(n.createElement)("div",{className:h()(t,"bwf-filters-advanced-input-range",{"is-between":"between"===i})},this.getFilterInputs())}});return Object(n.createElement)("fieldset",{className:"bwf-filters-advanced-line-item",tabIndex:"0"},Object(n.createElement)("legend",{className:"screen-reader-text"},c.add||""),Object(n.createElement)("div",{className:h()("bwf-filters-advanced-fieldset",{"is-english":o})},s),u&&Object(n.createElement)("span",{className:"screen-reader-text"},u))}}])&&xe(t.prototype,r),i&&xe(t,i),l}(n.Component),Be=r(25),Ve=r.n(Be),Ke=r(442);function Ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ye(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ye(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var He=function(e){var t=e.className,r=e.config,i=e.filter,c=e.isEnglish,l=e.onFilterChange,u=i.key,s=i.rule,p=i.value,b=r.labels,d=r.rules,m=Ue(Object(n.useState)([]),2),v=m[0],g=m[1];Object(n.useEffect)((function(){Ve()({path:"/wc/v3/products/attributes"}).then((function(e){return e.map((function(e){var t=e.id,r=e.name;return{key:t.toString(),label:r}}))})).then(g)}),[]);var j=Ue(Object(n.useState)(Array.isArray(p)?p[0]:""),2),w=j[0],S=j[1];Object(n.useEffect)((function(){Array.isArray(p)&&S(p[0])}),[p]);var E=Ue(Object(n.useState)([]),2),_=E[0],k=E[1];Object(n.useEffect)((function(){w&&(k([]),Ve()({path:"/wc/v3/products/attributes/".concat(w,"/terms")}).then((function(e){return e.map((function(e){var t=e.id,r=e.name;return{key:t.toString(),label:r}}))})).then(k))}),[w]);var F=Ue(Object(n.useState)(Array.isArray(p)&&p[1]||""),2),C=F[0],R=F[1],P=function(e){var t=e.attributes,r=e.attributeTerms,o=e.config,i=e.filter,c=e.selectedAttribute,l=e.selectedAttributeTerm;if(0===t.length||0===r.length||""===c||""===l)return"";var u=Array.isArray(o.rules)&&o.rules.find((function(e){return e.value===i.rule}))||{},s=t.find((function(e){return e.key===c})).label,f=r.find((function(e){return e.key===l})).label,p=y()({
/* translators: Sentence fragment describing a product attribute match. Example: "Color Is Not Blue" - attribute = Color, equals = Is Not, value = Blue */
mixedString:Object(a.__)("{{attribute /}} {{equals /}} {{value /}}","funnel-builder"),components:{attribute:Object(n.createElement)(n.Fragment,null,s),equals:Object(n.createElement)(n.Fragment,null,u.label),value:Object(n.createElement)(n.Fragment,null,f)}});return O(y()({mixedString:o.labels.title,components:{filter:Object(n.createElement)(n.Fragment,null,p),rule:Object(n.createElement)(n.Fragment,null),title:Object(n.createElement)(n.Fragment,null)}}))}({attributes:v,attributeTerms:_,config:r,filter:i,selectedAttribute:w,selectedAttributeTerm:C});return Object(n.createElement)("fieldset",{className:"bwf-filters-advanced-line-item",tabIndex:"0"},Object(n.createElement)("legend",{className:"screen-reader-text"},b.add||""),Object(n.createElement)("div",{className:h()("bwf-filters-advanced-fieldset",{"is-english":c})},y()({mixedString:b.title,components:{title:Object(n.createElement)("span",{className:t}),rule:Object(n.createElement)(f.SelectControl,{className:h()(t,"bwf-filters-advanced-rule"),options:d,value:s,onChange:Object(o.partial)(l,u,"rule"),"aria-label":b.rule}),filter:Object(n.createElement)("div",{className:h()(t,"bwf-filters-advanced-attribute-fieldset")},v.length>0?Object(n.createElement)(Ke.a,{className:"bwf-filters-advanced-input bwf-search",label:Object(a.__)("Attribute name","funnel-builder"),isSearchable:!0,showAllOnFocus:!0,options:v,selected:w,onChange:function(e){"string"!=typeof e&&(e=""),S(e),R(""),l(u,"value",[e])}}):Object(n.createElement)(f.Spinner,null),v.length>0&&""!==w&&(_.length?Object(n.createElement)(n.Fragment,null,Object(n.createElement)("span",{className:"bwf-filters-advanced-attribute-field-separator"},"="),Object(n.createElement)(Ke.a,{className:"bwf-filters-advanced-input bwf-search",label:Object(a.__)("Attribute value","funnel-builder"),isSearchable:!0,showAllOnFocus:!0,options:_,selected:C,onChange:function(e){"string"!=typeof e&&(e=""),R(e),l(u,"value",[w,e])}})):Object(n.createElement)(f.Spinner,null)))}})),P&&Object(n.createElement)("span",{className:"screen-reader-text"},P))};He.propTypes={config:c.a.shape({labels:c.a.shape({rule:c.a.string,title:c.a.string,filter:c.a.string}),rules:c.a.arrayOf(c.a.object),input:c.a.object}).isRequired,filter:c.a.shape({key:c.a.string,rule:c.a.string,value:c.a.arrayOf(c.a.oneOfType([c.a.string,c.a.number]))}).isRequired,onFilterChange:c.a.func.isRequired};var Qe=He;r(508);function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){Xe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ge(e){return function(e){if(Array.isArray(e))return Je(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Je(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function et(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tt(e,t){return(tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ot(e);if(t){var a=ot(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return nt(this,r)}}function nt(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?at(e):t}function at(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var it=[{value:"all",label:Object(a.__)("All","funnel-builder")},{value:"any",label:Object(a.__)("Any","funnel-builder")}],ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tt(e,t)}(u,e);var t,r,i,c=rt(u);function u(e){var t,r=e.query,a=e.config;return Ze(this,u),(t=c.apply(this,arguments)).state={match:r.match||"all",activeFilters:Object(l.b)(r,a.filters)},t.filterListRef=Object(n.createRef)(),t.onMatchChange=t.onMatchChange.bind(at(t)),t.onFilterChange=t.onFilterChange.bind(at(t)),t.getAvailableFilterKeys=t.getAvailableFilterKeys.bind(at(t)),t.addFilter=t.addFilter.bind(at(t)),t.removeFilter=t.removeFilter.bind(at(t)),t.clearFilters=t.clearFilters.bind(at(t)),t.getUpdateHref=t.getUpdateHref.bind(at(t)),t.updateFilter=t.updateFilter.bind(at(t)),t.onFilter=t.onFilter.bind(at(t)),t}return t=u,(r=[{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.config,n=t.query,a=e.query;Object(o.isEqual)(a,n)||this.setState({activeFilters:Object(l.b)(n,r.filters)})}},{key:"onMatchChange",value:function(e){var t=this.props.onAdvancedFilterAction;this.setState({match:e}),t("match",{match:e})}},{key:"onFilterChange",value:function(e,t,r){var n=this.state.activeFilters.map((function(n){return e===n.key?Object.assign({},n,Xe({},t,r)):n}));this.setState({activeFilters:n})}},{key:"updateFilter",value:function(e){var t=this.state.activeFilters.map((function(t){return e.key===t.key?e:t}));this.setState({activeFilters:t})}},{key:"removeFilter",value:function(e){var t=this.props.onAdvancedFilterAction,r=Ge(this.state.activeFilters),n=Object(o.findIndex)(r,(function(t){return t.key===e}));t("remove",r[n]),r.splice(n,1),this.setState({activeFilters:r}),0===r.length&&Object(l.d)().push(this.getUpdateHref([]))}},{key:"getTitle",value:function(){var e=this.state.match,t=this.props.config;return y()({mixedString:t.title,components:{select:Object(n.createElement)(f.SelectControl,{className:"bwf-filters-advanced-title-select",options:it,value:e,onChange:this.onMatchChange,"aria-label":Object(a.__)("Choose to apply any or all filters","funnel-builder")})}})}},{key:"getAvailableFilterKeys",value:function(){var e=this.props.config,t=this.state.activeFilters.map((function(e){return e.key}));return Object(o.difference)(Object.keys(e.filters),t)}},{key:"addFilter",value:function(e,t){var r=this,n=this.props,a=n.onAdvancedFilterAction,o=n.config.filters[e],i={key:e};Array.isArray(o.rules)&&o.rules.length&&(i.rule=o.rules[0].value),o.input&&o.input.options&&(i.value=Object(l.c)(o,o.input.options)),o.input&&"Search"===o.input.component&&(i.value=""),this.setState((function(e){return{activeFilters:[].concat(Ge(e.activeFilters),[i])}})),a("add",i),t(),setTimeout((function(){r.filterListRef.current.querySelector("li:last-of-type fieldset").focus()}))}},{key:"clearFilters",value:function(){(0,this.props.onAdvancedFilterAction)("clear_all"),this.setState({activeFilters:[],match:"all"})}},{key:"getUpdateHref",value:function(e,t){var r=this.props,n=r.path,a=r.query,o=r.config,i=Object(l.i)(e,a,o.filters),c="all"===t?void 0:t;return Object(l.f)(We(We({},i),{},{match:c}),n,a)}},{key:"isEnglish",value:function(){return/en[-|_]/.test(this.props.siteLocale)}},{key:"onFilter",value:function(){var e=this.props,t=e.onAdvancedFilterAction,r=e.query,n=e.config,a=this.state,o=a.activeFilters,i=a.match;t("filter",We(We({},Object(l.i)(o,r,n.filters)),{},{match:i}))}},{key:"orderFilters",value:function(e,t){var r=window.location.search,n=r.indexOf(e.key),a=r.indexOf(t.key);return-1===n||-1===a?0:n-a}},{key:"render",value:function(){var e=this,t=this.props,r=t.config,i=t.query,c=t.currency,l=this.state,u=l.activeFilters,s=l.match,p=this.getAvailableFilterKeys(),d=this.getUpdateHref(u,s),y="admin.php"+window.location.search===d||0===u.length,m=this.isEnglish();return Object(n.createElement)(v.a,{className:"bwf-filters-advanced bwf-analytics-card",title:this.getTitle()},Object(n.createElement)("ul",{className:"bwf-filters-advanced-list",ref:this.filterListRef},u.sort(this.orderFilters).map((function(t){var a=t.key,l=r.filters[a],u=l.input,s=l.labels;return Object(n.createElement)("li",{className:"bwf-filters-advanced-list-item",key:a},"SelectControl"===u.component&&Object(n.createElement)(P,{className:"bwf-filters-advanced-fieldset-item",filter:t,config:r.filters[a],onFilterChange:e.onFilterChange,isEnglish:m}),"Search"===u.component&&Object(n.createElement)(Y,{className:"bwf-filters-advanced-fieldset-item",filter:t,config:r.filters[a],onFilterChange:e.onFilterChange,isEnglish:m,query:i}),"Number"===u.component&&Object(n.createElement)(fe,{className:"bwf-filters-advanced-fieldset-item",filter:t,config:r.filters[a],onFilterChange:e.onFilterChange,isEnglish:m,query:i,currency:c}),"Currency"===u.component&&Object(n.createElement)(fe,{className:"bwf-filters-advanced-fieldset-item",filter:t,config:We(We({},r.filters[a]),{input:{type:"currency",component:"Currency"}}),onFilterChange:e.onFilterChange,isEnglish:m,query:i,currency:c}),"Date"===u.component&&Object(n.createElement)(Le,{className:"bwf-filters-advanced-fieldset-item",filter:t,config:r.filters[a],onFilterChange:e.onFilterChange,isEnglish:m,query:i,updateFilter:e.updateFilter}),"ProductAttribute"===u.component&&Object(n.createElement)(Qe,{className:"bwf-filters-advanced-fieldset-item",filter:t,config:r.filters[a],onFilterChange:e.onFilterChange,isEnglish:m,query:i,updateFilter:e.updateFilter}),Object(n.createElement)(f.Button,{className:h()("bwf-filters-advanced-line-item","bwf-filters-advanced-remove"),label:s.remove,onClick:Object(o.partial)(e.removeFilter,a)},Object(n.createElement)(b.a,{icon:"cross-small"})))}))),p.length>0&&Object(n.createElement)("div",{className:"bwf-filters-advanced-add-filter"},Object(n.createElement)(f.Dropdown,{className:"bwf-filters-advanced-add-filter-dropdown",position:"bottom center",renderToggle:function(e){var t=e.isOpen,r=e.onToggle;return Object(n.createElement)(f.Button,{className:"bwf-filters-advanced-add-button",onClick:r,"aria-expanded":t},Object(n.createElement)(b.a,{icon:"add-outline"}),Object(a.__)("Add a Filter","funnel-builder"))},renderContent:function(t){var a=t.onClose;return Object(n.createElement)("ul",{className:"bwf-filters-advanced-add-dropdown"},p.map((function(t){return Object(n.createElement)("li",{key:t},Object(n.createElement)(f.Button,{onClick:Object(o.partial)(e.addFilter,t,a)},r.filters[t].labels.add))})))}})),Object(n.createElement)("div",{className:"bwf-filters-advanced-controls"},y&&Object(n.createElement)(f.Button,{isPrimary:!0,disabled:!0},Object(a.__)("Filter","funnel-builder")),!y&&Object(n.createElement)(g.a,{className:"components-button is-primary is-button",type:"bwf-crm",href:d,onClick:this.onFilter},Object(a.__)("Filter","funnel-builder")),u.length>0&&Object(n.createElement)(g.a,{type:"bwf-crm",href:this.getUpdateHref([]),onClick:this.clearFilters},Object(a.__)("Clear all filters","funnel-builder"))))}}])&&et(t.prototype,r),i&&et(t,i),u}(n.Component);ct.propTypes={config:c.a.shape({title:c.a.string,filters:c.a.objectOf(c.a.shape({labels:c.a.shape({add:c.a.string,remove:c.a.string,rule:c.a.string,title:c.a.string,filter:c.a.string}),rules:c.a.arrayOf(c.a.object),input:c.a.object}))}).isRequired,path:c.a.string.isRequired,query:c.a.object,onAdvancedFilterAction:c.a.func,siteLocale:c.a.string,currency:c.a.object.isRequired},ct.defaultProps={query:{},onAdvancedFilterAction:function(){},siteLocale:"en_US"};var lt=ct,ut=function(e){var t=e.className,r=e.count,a=e.children,o=e.disabled,i=e.helpText,c=e.onClick;return!o&&r<2?Object(n.createElement)(f.Tooltip,{text:i},Object(n.createElement)("span",{className:t},Object(n.createElement)(f.Button,{className:"bwf-compare-button",disabled:!0,isSecondary:!0},a))):Object(n.createElement)(f.Button,{className:h()("bwf-compare-button",t),onClick:c,disabled:o,isSecondary:!0},a)};ut.propTypes={className:c.a.string,count:c.a.number.isRequired,children:c.a.node.isRequired,helpText:c.a.string.isRequired,onClick:c.a.func.isRequired,disabled:c.a.bool};var st=ut;function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yt(e,t){return(yt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=gt(e);if(t){var a=gt(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return ht(this,r)}}function ht(e,t){return!t||"object"!==ft(t)&&"function"!=typeof t?vt(e):t}function vt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gt(e){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ot=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yt(e,t)}(u,e);var t,r,i,c=mt(u);function u(e){var t,r=e.getLabels,n=e.param,a=e.query;return bt(this,u),(t=c.apply(this,arguments)).state={selected:[]},t.clearQuery=t.clearQuery.bind(vt(t)),t.updateQuery=t.updateQuery.bind(vt(t)),t.updateLabels=t.updateLabels.bind(vt(t)),a[n]&&r(a[n],a).then(t.updateLabels),t}return t=u,(r=[{key:"componentDidUpdate",value:function(e,t){var r=e.param,n=e.query,a=t.selected,i=this.props,c=i.getLabels,u=i.param,s=i.query,f=this.state.selected;if(r!==u||a.length>0&&0===f.length)this.clearQuery();else{var p=Object(l.e)(n[u]),b=Object(l.e)(s[u]);Object(o.isEqual)(p.sort(),b.sort())||c(s[u],s).then(this.updateLabels)}}},{key:"clearQuery",value:function(){var e=this.props,t=e.param,r=e.path,n=e.query;this.setState({selected:[]}),Object(l.j)(pt({},t,void 0),r,n)}},{key:"updateLabels",value:function(e){this.setState({selected:e})}},{key:"updateQuery",value:function(){var e=this.props,t=e.param,r=e.path,n=e.query,a=this.state.selected.map((function(e){return e.key}));Object(l.j)(pt({},t,a.join(",")),r,n)}},{key:"render",value:function(){var e=this,t=this.props,r=t.labels,o=t.type,i=this.state.selected;return Object(n.createElement)(v.a,{title:r.title,className:"bwf-filters-compare bwf-analytics-card"},Object(n.createElement)("div",{className:"bwf-filters-compare-body"},Object(n.createElement)(x.a,{type:o,selected:i,placeholder:r.placeholder,onChange:function(t){e.setState({selected:t})}})),Object(n.createElement)("div",{className:"bwf-filters-compare-footer"},Object(n.createElement)(st,{count:i.length,helpText:r.helpText,onClick:this.updateQuery},r.update),i.length>0&&Object(n.createElement)(f.Button,{isLink:!0,onClick:this.clearQuery},Object(a.__)("Clear all","funnel-builder"))))}}])&&dt(t.prototype,r),i&&dt(t,i),u}(n.Component);Ot.propTypes={getLabels:c.a.func.isRequired,labels:c.a.shape({placeholder:c.a.string,title:c.a.string,update:c.a.string}),param:c.a.string.isRequired,path:c.a.string.isRequired,query:c.a.object,type:c.a.string.isRequired},Ot.defaultProps={labels:{},query:{}};var jt=r(243),wt=r(409),St=r(143),Et=r(407),_t=r(545),kt=r(537);r(509);function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ct(){return(Ct=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Rt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nt(e);if(t){var a=Nt(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Dt(this,r)}}function Dt(e,t){return!t||"object"!==Ft(t)&&"function"!=typeof t?Tt(e):t}function Tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nt(e){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(i,e);var t,r,a,o=xt(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).state={animate:null},e.container=Object(n.createRef)(),e.onExited=e.onExited.bind(Tt(e)),e}return t=i,(r=[{key:"onExited",value:function(){var e=this.props.onExited;e&&e(this.container.current)}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.animationKey,a=e.animate,o=h()("bwf-slide-animation",a&&"animate-".concat(a));return Object(n.createElement)("div",{className:o,ref:this.container},Object(n.createElement)(_t.a,null,Object(n.createElement)(kt.a,Ct({timeout:200,classNames:"slide",key:r},this.props,{onExited:this.onExited}),(function(e){return t({status:e})}))))}}])&&Rt(t.prototype,r),a&&Rt(t,a),i}(n.Component);qt.propTypes={children:c.a.func.isRequired,animationKey:c.a.any.isRequired,animate:c.a.oneOf([null,"left","right"]),onExited:c.a.func};var At=qt,It=r(239);r(510);function Mt(e){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Bt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(r),!0).forEach((function(t){Vt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kt(e){return function(e){if(Array.isArray(e))return Ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ut(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ut(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ht(e,t){return(Ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Wt(e);if(t){var a=Wt(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return zt(this,r)}}function zt(e,t){return!t||"object"!==Mt(t)&&"function"!=typeof t?$t(e):t}function $t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wt(e){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ht(e,t)}(u,e);var t,r,i,c=Qt(u);function u(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var r=(t=c.call(this,e)).getFilter();if(t.state={nav:r.path||[],animate:null,selectedTag:null},t.selectSubFilter=t.selectSubFilter.bind($t(t)),t.getVisibleFilters=t.getVisibleFilters.bind($t(t)),t.updateSelectedTag=t.updateSelectedTag.bind($t(t)),t.onTagChange=t.onTagChange.bind($t(t)),t.onContentMount=t.onContentMount.bind($t(t)),t.goBack=t.goBack.bind($t(t)),r.settings&&r.settings.getLabels){var n=t.props.query,a=r.settings,o=a.param;(0,a.getLabels)(n[o],n).then(t.updateSelectedTag)}return t}return t=u,(r=[{key:"componentDidUpdate",value:function(e){var t=e.query,r=this.props,n=r.query,a=r.config;if(t[a.param]!==n[[a.param]]){var o=this.getFilter();if(o&&"Search"===o.component){this.setState({nav:o.path||[]});var i=o.settings,c=i.param;(0,i.getLabels)(n[c],n).then(this.updateSelectedTag)}}}},{key:"updateSelectedTag",value:function(e){this.setState({selectedTag:e[0]})}},{key:"getFilter",value:function(e){var t=this.props,r=t.config,n=t.query,a=Object(l.a)(r.filters);return e=e||n[r.param]||r.defaultValue||"all",Object(o.find)(a,{value:e})||{}}},{key:"getButtonLabel",value:function(e){if("Search"===e.component){var t=this.state.selectedTag;return[t&&t.label,Object(o.get)(e,"settings.labels.button")]}return e?[e.label]:[]}},{key:"getVisibleFilters",value:function(e,t){if(0===t.length)return e;var r=t[0],n=Object(o.find)(e,{value:r});return this.getVisibleFilters(n&&n.subFilters,t.slice(1))}},{key:"selectSubFilter",value:function(e){this.setState((function(t){return{nav:[].concat(Kt(t.nav),[e]),animate:"left"}}))}},{key:"goBack",value:function(){this.setState((function(e){return{nav:e.nav.slice(0,-1),animate:"right"}}))}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.props,n=r.path,a=r.query,o=r.config,i=r.onFilterSelect,c=Object(l.g)(a),u=Bt(Vt({},o.param,(o.defaultValue||"all")===e?void 0:e),t);o.staticParams.forEach((function(e){u[e]=a[e]})),Object(l.j)(u,n,c),i(u)}},{key:"onTagChange",value:function(e,t,r,n){var a=Object(o.last)(n),i=e.value,c=e.settings.param;a?(this.update(i,Vt({},c,a.key)),t()):this.update(r.defaultValue||"all"),this.updateSelectedTag([a])}},{key:"renderButton",value:function(e,t,r){var a=this;if(e.component){var i=e.settings,c=i.type,l=i.labels,u=this.getFilter().value===e.value?this.state.selectedTag:null;return Object(n.createElement)(x.a,{className:"bwf-filters-filter-search",type:c,placeholder:l.placeholder,selected:u?[u]:[],onChange:Object(o.partial)(this.onTagChange,e,t,r),inlineTags:!0,staticResults:!0})}var s=Object(o.partial)(this.selectSubFilter,e.value),p=this.getFilter(),b=p.value===e.value||p.path&&Object(o.includes)(p.path,e.value);return Object(n.createElement)(f.Button,{className:"bwf-filters-filter-button",onClick:function(r){b?t(r):e.subFilters?s(r):function(r){t(r),a.update(e.value,e.query||{}),a.setState({selectedTag:null})}(r)}},e.label)}},{key:"onContentMount",value:function(e){var t=this.state.nav,r=t.length&&this.getFilter(t[t.length-1])?1:0,n=wt.focus.tabbable.find(e)[r];setTimeout((function(){n.focus()}),0)}},{key:"render",value:function(){var e=this,t=this.props.config,r=this.state,i=r.nav,c=r.animate,l=this.getVisibleFilters(t.filters,i),u=!!i.length&&this.getFilter(i[i.length-1]),s=this.getFilter();return Object(n.createElement)("div",{className:"bwf-filters-filter"},t.label&&Object(n.createElement)("span",{className:"bwf-filters-label"},t.label,":"),Object(n.createElement)(f.Dropdown,{contentClassName:"bwf-filters-filter-content",position:"bottom",expandOnMobile:!0,headerTitle:Object(a.__)("filter report to show:","funnel-builder"),renderToggle:function(t){var r=t.isOpen,a=t.onToggle;return Object(n.createElement)(It.a,{onClick:a,isOpen:r,labels:e.getButtonLabel(s)})},renderContent:function(r){var a=r.onClose;return Object(n.createElement)(At,{animationKey:i,animate:c,onExited:e.onContentMount},(function(){return Object(n.createElement)("ul",{className:"bwf-filters-filter-content-list"},u&&Object(n.createElement)("li",{className:"bwf-filters-filter-content-list-item"},Object(n.createElement)(f.Button,{className:"bwf-filters-filter-button",onClick:e.goBack},Object(n.createElement)(St.a,{icon:Et.a}),u.label)),l.map((function(r){return Object(n.createElement)("li",{key:r.value,className:h()("bwf-filters-filter-content-list-item",{"is-selected":s.value===r.value||s.path&&Object(o.includes)(s.path,r.value)})},e.renderButton(r,a,t))})))}))}}))}}])&&Yt(t.prototype,r),i&&Yt(t,i),u}(n.Component);Gt.propTypes={config:c.a.shape({label:c.a.string,staticParams:c.a.array.isRequired,param:c.a.string.isRequired,defaultValue:c.a.string,showFilters:c.a.func.isRequired,filters:c.a.arrayOf(c.a.shape({chartMode:c.a.oneOf(["item-comparison","time-comparison"]),component:c.a.string,label:c.a.string,path:c.a.string,subFilters:c.a.array,value:c.a.string.isRequired}))}).isRequired,path:c.a.string.isRequired,query:c.a.object,onFilterSelect:c.a.func},Gt.defaultProps={query:{},onFilterSelect:function(){}};var Jt=Gt;r(391);function Xt(e){return(Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zt(){return(Zt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function er(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tr(e,t){return(tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=or(e);if(t){var a=or(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return nr(this,r)}}function nr(e,t){return!t||"object"!==Xt(t)&&"function"!=typeof t?ar(e):t}function ar(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function or(e){return(or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ir=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tr(e,t)}(s,e);var t,r,i,c=rr(s);function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=c.call(this)).renderCard=e.renderCard.bind(ar(e)),e.onRangeSelect=e.onRangeSelect.bind(ar(e)),e}return t=s,(r=[{key:"renderCard",value:function(e){var t=this.props,r=t.siteLocale,a=t.advancedFilters,i=t.query,c=t.path,l=t.onAdvancedFilterAction,u=t.currency,s=e.filters,f=e.param;if(!i[f])return null;if(0===i[f].indexOf("compare")){var p=Object(o.find)(s,{value:i[f]});if(!p)return null;var b=p.settings,d=void 0===b?{}:b;return Object(n.createElement)("div",{key:f,className:"bwf-filters-advanced-filters"},Object(n.createElement)(Ot,Zt({path:c,query:i},d)))}return"advanced"===i[f]?Object(n.createElement)("div",{key:f,className:"bwf-filters-advanced-filters"},Object(n.createElement)(lt,{siteLocale:r,currency:u,config:a,path:c,query:i,onAdvancedFilterAction:l})):void 0}},{key:"onRangeSelect",value:function(e){var t=this.props,r=t.query,n=t.path,a=t.onDateSelect;Object(l.j)(e,n,r),a(e)}},{key:"getDateQuery",value:function(e){var t=Object(u.f)(e),r=t.period,n=t.compare,a=t.before,o=t.after,i=Object(u.d)(e);return{period:r,compare:n,before:a,after:o,primaryDate:i.primary,secondaryDate:i.secondary}}},{key:"render",value:function(){var e=this.props,t=e.dateQuery,r=e.filters,o=e.query,i=e.path,c=e.showDatePicker,l=e.onFilterSelect,u=e.isoDateFormat;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(me.a,{className:"screen-reader-text"},Object(a.__)("Filters","funnel-builder")),Object(n.createElement)(me.b,{component:"div",className:"bwf-filters"},Object(n.createElement)("div",{className:"bwf-filters-basic-filters"},c&&Object(n.createElement)(jt.a,{key:JSON.stringify(o),dateQuery:t||this.getDateQuery(o),onRangeSelect:this.onRangeSelect,isoDateFormat:u}),r.map((function(e){return e.showFilters(o)?Object(n.createElement)(Jt,{key:e.param,config:e,query:o,path:i,onFilterSelect:l}):null}))),r.map(this.renderCard)))}}])&&er(t.prototype,r),i&&er(t,i),s}(n.Component);ir.propTypes={siteLocale:c.a.string,advancedFilters:c.a.object,filters:c.a.array,path:c.a.string.isRequired,query:c.a.object,showDatePicker:c.a.bool,onDateSelect:c.a.func,onFilterSelect:c.a.func,onAdvancedFilterAction:c.a.func,currency:c.a.object,dateQuery:c.a.shape({period:c.a.string.isRequired,compare:c.a.string.isRequired,before:c.a.object,after:c.a.object,primaryDate:c.a.shape({label:c.a.string.isRequired,range:c.a.string.isRequired}).isRequired,secondaryDate:c.a.shape({label:c.a.string.isRequired,range:c.a.string.isRequired})}),isoDateFormat:c.a.string},ir.defaultProps={siteLocale:"en_US",advancedFilters:{},filters:[],query:{},showDatePicker:!0,onDateSelect:function(){},currency:Object(s.a)().getCurrencyConfig()};var cr=ir,lr=function(e){var t=e.query;return Object(n.createElement)(cr,{siteLocale:"en-US",path:"/analytics",query:t,filterTitle:"Analytics",showDatePicker:!0})},ur=r(244),sr=r(89),fr=r(242),pr=r(13),br=(r(511),function(e){var t=e.data.current.totals,r=e.data.previous.totals,a=e.query,o=e.metrics,i=e.isLoading,c=e.error,u=a.hasOwnProperty("chart")?a.chart:o&&o.hasOwnProperty("length")?o[0].key:"",s=Object(pr.e)();return i?Object(n.createElement)(fr.a,{numberOfItems:e.metrics.length}):i||c?null:Object(n.createElement)(ur.a,null,(function(){return o?e.metrics.map((function(e){var a=e.key,o=e.label,i=e.isCurrency,c=i?s.formatAmount(parseFloat(t[a])):parseInt(t[a]),f=i?dr(parseFloat(t[a]),parseFloat(r[a])):dr(parseInt(t[a]),parseInt(r[a])),p=Object(l.f)({chart:a});return Object(n.createElement)(sr.a,{key:a,label:o,value:c,delta:f,href:Object(l.f)({chart:a}),onLinkClickCallback:function(e){Object(l.d)().push(p),e.preventDefault()},selected:a===u})})):null}))});function dr(e,t){if(!Number.isFinite(e)||!Number.isFinite(t))return null;if(0===e&&0===t)return 0;var r=e>=t?e:t,n=e<t?e:t;0===r&&(r=1);var a=Math.round((r-n)/r*100);return e>=t?a:-a}br.defaultProps={data:{current:{intervals:[],totals:{}},previous:{intervals:[],totals:{}}},metrics:[{key:"",label:"",isCurrency:!1}]};var yr=br,mr=r(28),hr=r(535),vr=r(544),gr=r(518),Or=r(50);function jr(e){return(jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Er(e,t){return(Er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Fr(e);if(t){var a=Fr(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return kr(this,r)}}function kr(e,t){return!t||"object"!==jr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fr(e){return(Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Er(e,t)}(i,e);var t,r,a,o=_r(i);function i(){return wr(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"render",value:function(){var e=this.props.height;return Object(n.createElement)("div",{"aria-hidden":"true",className:"bwf-chart-placeholder",style:{height:e}},Object(n.createElement)(f.Spinner,null))}}])&&Sr(t.prototype,r),a&&Sr(t,a),i}(n.Component);Cr.propTypes={height:c.a.number},Cr.defaultProps={height:0};var Rr=Cr,Pr=(r(512),r(540)),xr=r(532);r(513);function Dr(e){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Nr(e,t){return(Nr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ir(e);if(t){var a=Ir(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Ar(this,r)}}function Ar(e,t){return!t||"object"!==Dr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ir(e){return(Ir=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nr(e,t)}(c,e);var t,r,a,i=qr(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=i.call(this,e)).chartRef=Object(n.createRef)(),t}return t=c,(r=[{key:"componentDidMount",value:function(){this.drawUpdatedChart()}},{key:"shouldComponentUpdate",value:function(e){return this.props.className!==e.className||!Object(o.isEqual)(this.props.data,e.data)||!Object(o.isEqual)(this.props.orderedKeys,e.orderedKeys)||this.props.drawChart!==e.drawChart||this.props.height!==e.height||this.props.chartType!==e.chartType||this.props.width!==e.width}},{key:"componentDidUpdate",value:function(){this.drawUpdatedChart()}},{key:"componentWillUnmount",value:function(){this.deleteChart()}},{key:"delayedScroll",value:function(){var e=this.props.tooltip;return Object(o.throttle)((function(){e&&e.hide()}),300)}},{key:"deleteChart",value:function(){Object(xr.a)(this.chartRef.current).selectAll("svg").remove()}},{key:"drawUpdatedChart",value:function(){(0,this.props.drawChart)(this.getContainer())}},{key:"getContainer",value:function(){var e=this.props,t=e.className,r=e.height,n=e.width;this.deleteChart();var a=Object(xr.a)(this.chartRef.current).append("svg").attr("viewBox","0 0 ".concat(n," ").concat(r)).attr("height",r).attr("width",n).attr("preserveAspectRatio","xMidYMid meet");return t&&a.attr("class","".concat(t,"__viewbox")),a.append("g")}},{key:"render",value:function(){var e=this.props.className;return Object(n.createElement)("div",{className:h()("d3-base",e),ref:this.chartRef,onScroll:this.delayedScroll()})}}])&&Tr(t.prototype,r),a&&Tr(t,a),c}(n.Component);function Lr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||Vr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Br(e){return function(e){if(Array.isArray(e))return Kr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Vr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vr(e,t){if(e){if("string"==typeof e)return Kr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kr(e,t):void 0}}function Kr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Mr.propTypes={className:c.a.string,data:c.a.array,orderedKeys:c.a.array,tooltip:c.a.object,chartType:c.a.string};var Ur=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hr.b;return"function"==typeof e?e:t(e)},Yr=function(e){return Br(new Set(e.reduce((function(e,t){return e.concat(Object.keys(t))}),[]))).filter((function(e){return"date"!==e}))},Hr=r(542),Qr=r(536),zr=r(541);function $r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Gr=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(Hr.a)().domain(e.filter((function(e){return e.visible})).map((function(e){return e.key}))).rangeRound([0,t.bandwidth()]).padding(r?0:.07)},Jr=function(e,t){return Object(Qr.a)().domain([be()(e[0],"YYYY-MM-DD HH:mm").toDate(),be()(e[e.length-1],"YYYY-MM-DD HH:mm").toDate()]).rangeRound([0,t])},Xr=function(e){var t=function(e){var t=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return e.forEach((function(e){for(var n=0,a=Object.entries(e);n<a.length;n++){var o=$r(a[n],2),i=o[0],c=o[1];"date"!==i&&Number.isFinite(c.value)&&c.value>t&&(t=c.value),"date"!==i&&Number.isFinite(c.value)&&c.value<r&&(r=c.value)}})),{upper:t,lower:r}}(e),r=t.lower,n=t.upper,a=function(e,t){if(!Number.isFinite(e)||!Number.isFinite(t))return 1;if(0===t&&0===e)return 1/3;var r=4/3*Math.max(-e,t),n=3*Math.pow(10,(Math.log(r)*Math.LOG10E+1|0)-2),a=Math.ceil(r/n)*n/3;return t<1&&e>-1?Math.round(4*a)/4:Math.ceil(a)}(r,n),o={lower:0,upper:0,step:a};return(Number.isFinite(r)||r<0)&&(o.lower=Math.floor(r/a)*a,o.lower===r&&0!==r&&(o.lower-=a)),(Number.isFinite(n)||n>0)&&(o.upper=Math.ceil(n/a)*a,o.upper===n&&0!==n&&(o.upper+=a)),o},Zr=r(543),en=function(e){for(var t=[],r=1;r<=Math.floor(Math.sqrt(e));r++)e%r==0&&(t.push(r),e/r!==r&&t.push(e/r));return t.sort((function(e,t){return e-t})),t},tn=function(e,t,r,n){var a,o=function(e,t){if(e<783)return 7;if(e>=783&&e<=1130)return 12;if(e>1130&&e<=1365){if("time-comparison"===t)return 16;if("item-comparison"===t)return 12}else if(e>1365){if("time-comparison"===t)return 31;if("item-comparison"===t)return 16}return 16}(t,r);return(e.length>=63&&"day"===n||e.length>=9&&"week"===n)&&(e=(a=e).filter((function(e,t){return 0===t||be()(e).toDate().getMonth()!==be()(a[t-1]).toDate().getMonth()}))),e.length<=o||"hour"===n&&function(e){var t=be()(e[0]).toDate(),r=be()(e[e.length-1]).toDate();return t.getDate()===r.getDate()&&t.getMonth()===r.getMonth()&&t.getFullYear()===r.getFullYear()}(e)&&t>783?e:function(e,t){for(var r=[],n=0;n<e.length;n+=t)r.push(e[n]);return r[0]!==e[0]&&r.unshift(e[0]),r}(e,function(e,t){for(var r=[],n=1;r.length<=3;)r=en(e.length-n),n+=1;return r.find((function(r){return e.length/r<t}))}(e,o))},rn=function(e,t,r,n){var a=be()(e).toDate(),o=0!==t?r[t-1]:r[t];return o=o instanceof Date?o:be()(o).toDate(),0===t?n(a):function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new RegExp([" |,"],"g"),n=e.split(r),a=t.split(r),o=new Array,i=e.length>t.length?n:a,c=0;c<i.length;c++)n[c]!==a[c]&&o.push(a[c]);return o}(n(o),n(a)).join(" ")};function nn(e){return function(e){if(Array.isArray(e))return an(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return an(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return an(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function an(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var on=function(e,t,r){for(var n=[],a=0;a<e;a++){var o=(a+1)/e*t,i=r?Math.round(o):o;n[n.length-1]!==i&&n.push(i)}return n},cn=function(e,t,r){return[0].concat(nn(function(e,t){if(e>=0)return[];var r=Math.ceil(-e/t);return on(r,e,e<-1)}(e,r)),nn(function(e,t){if(e<=0)return[];var r=Math.ceil(e/t);return on(r,e,e>1)}(t,r)))},ln=function(e,t,r,n,a,o){!function(e,t,r,n){var a=r.yScale.range()[0],o=tn(t.uniqueDates,r.xScale.range()[1],t.mode,t.interval);"line"===t.chartType&&(o=o.map((function(e){return be()(e).toDate()}))),e.append("g").attr("class","axis").attr("aria-hidden","true").attr("transform","translate(0, ".concat(a,")")).call(Object(Zr.a)(r.xScale).tickValues(o).tickFormat((function(e,r){return"hour"===t.interval?n.xFormat(e instanceof Date?e:be()(e).toDate()):rn(e,r,o,n.xFormat)}))),e.append("g").attr("class","axis axis-month").attr("aria-hidden","true").attr("transform","translate(0, ".concat(a+14,")")).call(Object(Zr.a)(r.xScale).tickValues(o).tickFormat((function(e,t){return rn(e,t,o,n.x2Format)}))),e.append("g").attr("class","pipes").attr("transform","translate(0, ".concat(a,")")).call(Object(Zr.a)(r.xScale).tickValues(o).tickSize(5).tickFormat(""))}(e,t,r,n),function(e,t,r,n,a){var o=cn(t.yScale.domain()[0],t.yScale.domain()[1],t.step),i=t.xScale.range()[1],c=a?i+n.left+n.right/2-15:-n.left/2-15,l=t.yMin>=0||t.yMax>0?" with-positive-ticks":"";e.append("g").attr("class","grid"+l).attr("transform","translate(-".concat(n.left,", 0)")).call(Object(Zr.b)(t.yScale).tickValues(o).tickSize(-i-n.left-n.right).tickFormat("")),e.append("g").attr("class","axis y-axis").attr("aria-hidden","true").attr("transform","translate("+c+", 12)").attr("text-anchor","start").call(Object(Zr.b)(t.yScale).tickValues(0===t.yMax&&0===t.yMin?[o[0]]:o).tickFormat((function(e){return e>-1&&e<1&&r.yBelow1Format?r.yBelow1Format(e):r.yFormat(e)})))}(e,r,n,a,o),e.selectAll(".domain").remove(),e.selectAll(".axis .tick line").remove()},un=r(514),sn=r(538);function fn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fn(Object(r),!0).forEach((function(t){bn(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var dn=function(e,t,r,n,a,i){var c,l,u=n.yScale.range()[0],s=n.xScale.range()[1],f=(c=n.xScale,l=n.yScale,Object(sn.a)().x((function(e){return c(be()(e.date).toDate())})).y((function(e){return l(e.value)}))),p=function(e,t){return t.map((function(t){return{key:t.key,focus:t.focus,visible:t.visible,label:t.label,values:e.map((function(e){return{date:e.date,focus:t.focus,value:e.hasOwnProperty(t.key)&&e[t.key].hasOwnProperty("value")?e[t.key].value:0,visible:t.visible}}))}}))}(t,r.visibleKeys),b=e.append("g").attr("class","lines").selectAll(".line-g").data(p.filter((function(e){return e.visible})).reverse()).enter().append("g").attr("class","line-g").attr("role","region").attr("aria-label",(function(e){return e.label||e.key})),d=function(e,t,r,n,a){var i=r.slice().reverse();return t.map((function(r,c){var l=Object(o.first)(e.filter((function(e){return e.date===r}))),u=a(be()(r).toDate()),s=a(c>=1?be()(t[c-1]).toDate():be()(t[0]).toDate()),f=c<t.length-1?a(be()(t[c+1]).toDate()):a(be()(t[t.length-1]).toDate()),p=0===c?f-u:u-s,b=0===c?0:u-p/2;return p=0===c||c===t.length-1?p/2:p,{date:r,start:t.length>1?b:0,width:t.length>1?p:n,values:i.map((function(e){var t=e.key,n=l[t];return n?{key:t,value:n.value,date:r}:null})).filter(Boolean)}}))}(t,r.uniqueDates,r.visibleKeys,s,n.xScale),y=s<=1365||r.uniqueDates.length>50?2:3;y=s<=783?1.25:y;var m=s<=1365?4:6;r.uniqueDates.length>1&&b.append("path").attr("fill","none").attr("stroke-width",y).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("stroke",(function(e){return r.getColor(e.key)})).style("opacity",(function(e){var t=e.focus?1:.1;return e.visible?t:0})).attr("d",(function(e){return f(e.values)}));s/r.uniqueDates.length>36&&b.selectAll("circle").data((function(e,t){return e.values.map((function(r){return pn(pn({},r),{},{i:t,visible:e.visible,key:e.key})}))})).enter().append("circle").attr("r",m).attr("fill",(function(e){return r.getColor(e.key)})).attr("stroke","#fff").attr("stroke-width",y+1).style("opacity",(function(e){var t=e.focus?1:.1;return e.visible?t:0})).attr("cx",(function(e){return n.xScale(be()(e.date).toDate())})).attr("cy",(function(e){return n.yScale(e.value)})).attr("tabindex","0").attr("aria-label",(function(e){var t=a.screenReaderFormat(e.date instanceof Date?e.date:be()(e.date).toDate());return"".concat(t," ").concat(i.valueFormat(e.value))})).on("focus",(function(e,r,n){i.show(t.find((function(t){return t.date===e.date})),n[r].parentNode,un.b.target)})).on("blur",(function(){return i.hide()}));var h=e.append("g").attr("class","focusspaces").selectAll(".focus").data(d).enter().append("g").attr("class","focus"),v=h.append("g").attr("class","focus-grid").attr("opacity","0");v.append("line").attr("x1",(function(e){return n.xScale(be()(e.date).toDate())})).attr("y1",0).attr("x2",(function(e){return n.xScale(be()(e.date).toDate())})).attr("y2",u),v.selectAll("circle").data((function(e){return e.values})).enter().append("circle").attr("r",m+2).attr("fill",(function(e){return r.getColor(e.key)})).attr("stroke","#fff").attr("stroke-width",y+2).attr("cx",(function(e){return n.xScale(be()(e.date).toDate())})).attr("cy",(function(e){return n.yScale(e.value)})),h.append("rect").attr("class","focus-g").attr("x",(function(e){return e.start})).attr("y",0).attr("width",(function(e){return e.width})).attr("height",u).attr("opacity",0).on("mouseover",(function(e,n,a){var o=(0===n||n===d.length-1)&&r.uniqueDates.length>1?0:.5;i.show(t.find((function(t){return t.date===e.date})),un.b.target,a[n].parentNode,o)})).on("mouseout",(function(){return i.hide()}))},yn=[[],[.5],[.333,.667],[.2,.5,.8],[.12,.375,.625,.88],[0,.25,.5,.75,1]],mn=function(e,t){return function(r){var n=e.length>5?5:e.length,a=Object(o.findIndex)(e,(function(e){return e.key===r})),i=a<=4?yn[n][a]:0;return t(i)}};function hn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var vn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ref=null,this.chart=null,this.position="",this.title="",this.labelFormat="",this.valueFormat="",this.visibleKeys="",this.getColor=null,this.margin=24}var t,r,n;return t=e,(r=[{key:"calculateXPosition",value:function(e,t,r){var n=this.ref.getBoundingClientRect(),a=this.ref.parentNode.querySelector(".d3-base").getBoundingClientRect(),o=Math.max(a.left,t.left);if("below"===this.position)return Math.max(this.margin,Math.min(e.left+.5*e.width-n.width/2-o,a.width-n.width-this.margin));var i=e.left+e.width*r+this.margin-o;return i+n.width+this.margin>a.width?Math.max(this.margin,e.left+e.width*(1-r)-n.width-this.margin-o):i}},{key:"calculateYPosition",value:function(e,t){if("below"===this.position)return t.height;var r=this.ref.getBoundingClientRect(),n=e.top+this.margin-t.top;return n+r.height+this.margin>t.height?Math.max(0,e.top-r.height-this.margin-t.top):n}},{key:"calculatePosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.getBoundingClientRect(),n=this.chart.getBoundingClientRect();return"below"===this.position&&(t=0),{x:this.calculateXPosition(r,n,t),y:this.calculateYPosition(r,n)}}},{key:"hide",value:function(){Object(xr.a)(this.chart).selectAll(".barfocus, .focus-grid").attr("opacity","0"),Object(xr.a)(this.ref).style("visibility","hidden")}},{key:"getTooltipRowLabel",value:function(e,t){return e[t.key].labelDate?this.labelFormat(be()(e[t.key].labelDate).toDate()):t.label||t.key}},{key:"show",value:function(e,t,r){var n=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(this.visibleKeys.length){Object(xr.a)(r).select(".focus-grid, .barfocus").attr("opacity","1");var o=this.calculatePosition(t,a),i=this.visibleKeys.map((function(t){return'\n\t\t\t\t\t<li class="key-row">\n\t\t\t\t\t\t<div class="key-container">\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass="key-color"\n\t\t\t\t\t\t\t\tstyle="background-color: '.concat(n.getColor(t.key),'">\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class="key-key">').concat(n.getTooltipRowLabel(e,t),'</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class="key-value">').concat(n.valueFormat(e[t.key].value),"</span>\n\t\t\t\t\t</li>\n\t\t\t\t")})),c=this.title?this.title:this.labelFormat(be()(e.date).toDate());Object(xr.a)(this.ref).style("left",o.x+"px").style("top",o.y+"px").style("visibility","visible").html("\n\t\t\t\t<div>\n\t\t\t\t\t<h4>".concat(c,"</h4>\n\t\t\t\t\t<ul>\n\t\t\t\t\t").concat(i.join(""),"\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t"))}}}])&&hn(t.prototype,r),n&&hn(t,n),e}();function gn(e){return(gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function On(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jn(e,t){return(jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_n(e);if(t){var a=_n(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Sn(this,r)}}function Sn(e,t){return!t||"object"!==gn(t)&&"function"!=typeof t?En(e):t}function En(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _n(e){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kn=function(){return"rtl"===document.documentElement.dir},Fn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jn(e,t)}(c,e);var t,r,a,i=wn(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=i.call(this,e)).drawChart=t.drawChart.bind(En(t)),t.getParams=t.getParams.bind(En(t)),t.tooltipRef=Object(n.createRef)(),t}return t=c,(r=[{key:"getFormatParams",value:function(){var e=this.props,t=e.screenReaderFormat,r=e.xFormat,n=e.x2Format,a=e.yFormat,o=e.yBelow1Format;return{screenReaderFormat:Ur(t,Pr.a),xFormat:Ur(r,Pr.a),x2Format:Ur(n,Pr.a),yBelow1Format:Ur(o),yFormat:Ur(a)}}},{key:"getScaleParams",value:function(e){var t=this.props,r=t.data,n=t.height,a=t.orderedKeys,o=t.chartType,i=this.getMargin(),c=n-i.top-i.bottom,l=this.getWidth()-i.left-i.right,u=Xr(r),s=u.upper,f=u.lower,p=u.step,b=function(e,t,r){return Object(zr.a)().domain([Math.min(t,0),0===r&&0===t?1:Math.max(r,0)]).rangeRound([e,0])}(c,f,s);if("line"===o)return{step:p,xScale:Jr(e,l),yMax:s,yMin:f,yScale:b};var d=this.shouldBeCompact(),y=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(Hr.a)().domain(e).range([0,t]).paddingInner(r?0:.1)}(e,l,d);return{step:p,xGroupScale:Gr(a,y,d),xScale:y,yMax:s,yMin:f,yScale:b}}},{key:"getParams",value:function(e){var t=this.props,r=t.chartType,n=t.colorScheme,a=t.data,o=t.interval,i=t.mode,c=t.orderedKeys||function(e){return Yr(e).map((function(t){return{key:t,focus:!0,total:e.reduce((function(e,r){return e+r[t].value}),0),visible:!0}})).sort((function(e,t){return t.total-e.total}))}(a),l=c.filter((function(e){return e.visible})),u=c.length>5?l:c;return{getColor:mn(u,n),interval:o,mode:i,chartType:r,uniqueDates:e,visibleKeys:l}}},{key:"createTooltip",value:function(e,t,r){var n=this.props,a=n.tooltipLabelFormat,o=n.tooltipPosition,i=n.tooltipTitle,c=n.tooltipValueFormat,l=new vn;l.ref=this.tooltipRef.current,l.chart=e,l.position=o,l.title=i,l.labelFormat=Ur(a,Pr.a),l.valueFormat=Ur(c),l.visibleKeys=r,l.getColor=t,this.tooltip=l}},{key:"drawChart",value:function(e){var t=this.props,r=t.data,n=t.dateParser,a=t.chartType,o=this.getMargin(),i=function(e,t){var r=Object(Pr.b)(t);return Br(new Set(e.map((function(e){return e.date})))).sort((function(e,t){return r(e)-r(t)}))}(r,n),c=this.getFormatParams(),l=this.getParams(i),u=this.getScaleParams(i),s=e.attr("id","chart").append("g").attr("transform","translate(".concat(o.left,", ").concat(o.top,")"));this.createTooltip(s.node(),l.getColor,l.visibleKeys),ln(s,l,u,c,o,kn()),"line"===a&&dn(s,r,l,u,c,this.tooltip),"bar"===a&&function(e,t,r,n,a,o){var i=n.yScale.range()[0],c=e.append("g").attr("class","bars").selectAll("g").data(t).enter().append("g").attr("transform",(function(e){return"translate(".concat(n.xScale(e.date),", 0)")})).attr("class","bargroup").attr("role","region").attr("aria-label",(function(e){return"item-comparison"===r.mode?a.screenReaderFormat(e.date instanceof Date?e.date:be()(e.date).toDate()):null}));c.append("rect").attr("class","barfocus").attr("x",0).attr("y",0).attr("width",n.xGroupScale.range()[1]).attr("height",i).attr("opacity","0").on("mouseover",(function(e,r,n){o.show(t.find((function(t){return t.date===e.date})),un.b.target,n[r].parentNode)})).on("mouseout",(function(){return o.hide()}));var l=n.yScale(0);c.selectAll(".bar").data((function(e){return r.visibleKeys.map((function(t){return{key:t.key,focus:t.focus,value:e.hasOwnProperty(t.key)&&e[t.key].hasOwnProperty("value")?e[t.key].value:0,label:t.label,visible:t.visible,date:e.date}}))})).enter().append("rect").attr("class","bar").attr("x",(function(e){return n.xGroupScale(e.key)})).attr("y",(function(e){return Math.min(l,n.yScale(e.value))})).attr("width",n.xGroupScale.bandwidth()).attr("height",(function(e){return Math.abs(l-n.yScale(e.value))})).attr("fill",(function(e){return r.getColor(e.key)})).attr("pointer-events","none").attr("tabindex","0").attr("aria-label",(function(e){var n=e.label||e.key;if("time-comparison"===r.mode){var i=t.find((function(t){return t.date===e.date}));n=a.screenReaderFormat(be()(i[e.key].labelDate).toDate())}return"".concat(n," ").concat(o.valueFormat(e.value))})).style("opacity",(function(e){var t=e.focus?1:.1;return e.visible?t:0})).on("focus",(function(e,r,n){var a=e.value>0?un.b.target:un.b.target.parentNode;o.show(t.find((function(t){return t.date===e.date})),a,n[r].parentNode)})).on("blur",(function(){return o.hide()}))}(s,r,l,u,c,this.tooltip)}},{key:"shouldBeCompact",value:function(){var e=this.props,t=e.data,r=e.chartType,n=e.width;if("bar"!==r)return!1;var a=this.getMargin(),o=n-a.left-a.right,i=t&&t.length?Object.keys(t[0]).length-1:0;return o<t.length*(i+1)}},{key:"getMargin",value:function(){var e=this.props.margin;return kn()?{bottom:e.bottom,left:e.right,right:e.left,top:e.top}:e}},{key:"getWidth",value:function(){var e=this.props,t=e.data,r=e.chartType,n=e.width;if("bar"!==r)return n;var a=this.getMargin(),o=t&&t.length?Object.keys(t[0]).length-1:0,i=this.shouldBeCompact()?t.length*o:t.length*(o+1);return Math.max(n,i+a.left+a.right)}},{key:"getEmptyMessage",value:function(){var e=this.props,t=e.baseValue,r=e.data,a=e.emptyMessage;if(a&&function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<e.length;r++)for(var n=0,a=Object.entries(e[r]);n<a.length;n++){var i=Lr(a[n],2),c=i[0],l=i[1];if("date"!==c&&!Object(o.isNil)(l.value)&&l.value!==t)return!1}return!0}(r,t))return Object(n.createElement)("div",{className:"d3-chart__empty-message"},a)}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.data,a=e.height,o=e.orderedKeys,i=e.chartType,c=this.getWidth();return Object(n.createElement)("div",{className:h()("d3-chart__container",t),style:{height:a}},this.getEmptyMessage(),Object(n.createElement)("div",{className:"d3-chart__tooltip",ref:this.tooltipRef}),Object(n.createElement)(Mr,{className:h()(t),data:r,drawChart:this.drawChart,height:a,orderedKeys:o,tooltip:this.tooltip,chartType:i,width:c}))}}])&&On(t.prototype,r),a&&On(t,a),c}(n.Component);Fn.propTypes={baseValue:c.a.number,className:c.a.string,colorScheme:c.a.func,data:c.a.array.isRequired,dateParser:c.a.string.isRequired,emptyMessage:c.a.string,height:c.a.number,interval:c.a.oneOf(["hour","day","week","month","quarter","year"]),margin:c.a.shape({bottom:c.a.number,left:c.a.number,right:c.a.number,top:c.a.number}),mode:c.a.oneOf(["item-comparison","time-comparison"]),screenReaderFormat:c.a.oneOfType([c.a.string,c.a.func]),orderedKeys:c.a.array,tooltipLabelFormat:c.a.oneOfType([c.a.string,c.a.func]),tooltipValueFormat:c.a.oneOfType([c.a.string,c.a.func]),tooltipPosition:c.a.oneOf(["below","over"]),tooltipTitle:c.a.string,chartType:c.a.oneOf(["bar","line"]),width:c.a.number,xFormat:c.a.oneOfType([c.a.string,c.a.func]),x2Format:c.a.oneOfType([c.a.string,c.a.func]),yBelow1Format:c.a.oneOfType([c.a.string,c.a.func]),yFormat:c.a.oneOfType([c.a.string,c.a.func])},Fn.defaultProps={baseValue:0,data:[],dateParser:"%Y-%m-%dT%H:%M:%S",height:200,margin:{bottom:30,left:40,right:0,top:20},mode:"time-comparison",screenReaderFormat:"%B %-d, %Y",tooltipPosition:"over",tooltipLabelFormat:"%B %-d, %Y",tooltipValueFormat:",",chartType:"line",width:600,xFormat:"%Y-%m-%d",x2Format:"",yBelow1Format:".3~f",yFormat:".3~s"};var Cn=Fn;function Rn(e){return(Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xn(e,t){return(xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nn(e);if(t){var a=Nn(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Tn(this,r)}}function Tn(e,t){return!t||"object"!==Rn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nn(e){return(Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xn(e,t)}(c,e);var t,r,o,i=Dn(c);function c(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(e=i.call(this)).listRef=Object(n.createRef)(),e.state={isScrollable:!1},e}return t=c,(r=[{key:"componentDidMount",value:function(){this.updateListScroll(),window.addEventListener("resize",this.updateListScroll)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateListScroll)}},{key:"updateListScroll",value:function(){if(this&&this.listRef){var e=this.listRef.current,t=e.scrollHeight-e.scrollTop<=e.offsetHeight;this.setState({isScrollable:!t})}}},{key:"render",value:function(){var e=this.props,t=e.colorScheme,r=e.data,o=e.handleLegendHover,i=e.handleLegendToggle,c=e.interactive,l=e.legendDirection,u=e.legendValueFormat,s=e.instanceId,f=e.totalLabel,p=this.state.isScrollable,b=r.filter((function(e){return e.visible})),d=b.length,y="column"===l&&r.length>5&&f,m=r.length>5?b:r;return Object(n.createElement)("div",{className:h()("bwf-legend","bwf-legend-direction-".concat(l),{"has-total":y,"is-scrollable":p},this.props.className)},Object(n.createElement)("ul",{className:"bwf-legend-list",ref:this.listRef,onScroll:y?this.updateListScroll:null},r.map((function(e){return Object(n.createElement)("li",{className:h()("bwf-legend-item",{"bwf-legend-item-checked":e.visible}),key:e.key,id:"bwf-legend-".concat(s,"__item__").concat(e.key),onMouseEnter:o,onMouseLeave:o,onBlur:o,onFocus:o},Object(n.createElement)("button",{onClick:i,id:"bwf-legend-".concat(s,"__item-button__").concat(e.key),disabled:e.visible&&d<=1||!e.visible&&d>=5||!c,title:d>=5?Object(a.sprintf)(Object(a.__)("You may select up to %d items.","funnel-builder"),5):""},Object(n.createElement)("div",{className:"bwf-legend-item-container"},Object(n.createElement)("span",{className:h()("bwf-legend-item-checkmark",{"bwf-legend-item-checkmark-checked":e.visible}),style:e.visible?{color:mn(m,t)(e.key)}:null}),Object(n.createElement)("span",{className:"bwf-legend-item-title"},e.label),Object(n.createElement)("span",{className:"bwf-legend-item-total"},Ur(u)(e.total)))))}))),y&&Object(n.createElement)("div",{className:"bwf-legend-total"},f))}}])&&Pn(t.prototype,r),o&&Pn(t,o),c}(n.Component);qn.propTypes={className:c.a.string,colorScheme:c.a.func,data:c.a.array.isRequired,handleLegendToggle:c.a.func,handleLegendHover:c.a.func,interactive:c.a.bool,legendDirection:c.a.oneOf(["row","column"]),legendValueFormat:c.a.oneOfType([c.a.string,c.a.func]),totalLabel:c.a.string,instanceId:c.a.number},qn.defaultProps={interactive:!0,legendDirection:"row",legendValueFormat:","};var An=Object(H.withInstanceId)(qn);r(517);function In(e){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ln(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ln(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ln(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vn(e,t){return(Vn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Hn(e);if(t){var a=Hn(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Un(this,r)}}function Un(e,t){return!t||"object"!==In(t)&&"function"!=typeof t?Yn(e):t}function Yn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hn(e){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qn(e,t){switch(t){case"left_space":return[e+" ",""];case"right":return["",e];case"right_space":return[""," "+e];case"left":default:return[e,""]}}var zn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vn(e,t)}(u,e);var t,r,i,c=Kn(u);function u(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e)).chartBodyRef=Object(n.createRef)();var r=t.getDataKeys();return t.state={focusedKeys:[],visibleKeys:r.slice(0,5),width:0},t.prevDataKeys=r.sort(),t.handleTypeToggle=t.handleTypeToggle.bind(Yn(t)),t.handleLegendToggle=t.handleLegendToggle.bind(Yn(t)),t.handleLegendHover=t.handleLegendHover.bind(Yn(t)),t.updateDimensions=t.updateDimensions.bind(Yn(t)),t.getVisibleData=Object(gr.a)(t.getVisibleData),t.getOrderedKeys=Object(gr.a)(t.getOrderedKeys),t.setInterval=t.setInterval.bind(Yn(t)),t}return t=u,(r=[{key:"getDataKeys",value:function(){var e=this.props,t=e.data,r=e.filterParam,n=e.mode,a=e.query;if("item-comparison"===n){var o=r?Object(l.e)(a[r]):[];return this.getOrderedKeys([],[],o).map((function(e){return e.key}))}return Yr(t)}},{key:"componentDidUpdate",value:function(){var e=this.props.data;if(e&&e.length){var t=Yr(e).sort();if(!Object(o.isEqual)(t,this.prevDataKeys)){var r=this.getDataKeys();this.prevDataKeys=t,this.setState({visibleKeys:r.slice(0,5)})}}}},{key:"componentDidMount",value:function(){this.updateDimensions(),this.setD3DefaultFormat(),window.addEventListener("resize",this.updateDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"setD3DefaultFormat",value:function(){var e=this.props.currency,t=e.symbol,r=e.symbolPosition,n=e.decimalSeparator,a=e.thousandSeparator;Object(hr.a)({decimal:n,thousands:a,grouping:[3],currency:Qn(t,r)})}},{key:"getOrderedKeys",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=this.props,a=n.data,o=n.legendTotals,i=n.mode;if(!a||0===a.length)return[];var c=a.reduce((function(e,t){return Object.entries(t).forEach((function(t){var r=Mn(t,2),n=r[0],a=r[1];"date"===n||e[n]||(e[n]=a.label)})),e}),{}),l=Object.entries(c).map((function(r){var n=Mn(r,2),i=n[0],c=n[1];return{focus:0===e.length||e.includes(i),key:i,label:c,total:o&&void 0!==o[i]?o[i]:a.reduce((function(e,t){return e+t[i].value}),0),visible:t.includes(i)}}));return"item-comparison"===i?l.sort((function(e,t){return t.total-e.total})).filter((function(e){return e.total>0||r.includes(parseInt(e.key,10))})):l}},{key:"handleTypeToggle",value:function(e){if(this.props.chartType!==e){var t=this.props,r=t.path,n=t.query;Object(l.j)({chartType:e},r,n)}}},{key:"handleLegendToggle",value:function(e){if(this.props.interactiveLegend){var t=e.currentTarget.id.split("_").pop(),r=this.state,n=r.focusedKeys,a=r.visibleKeys;a.includes(t)?this.setState({focusedKeys:Object(o.without)(n,t),visibleKeys:Object(o.without)(a,t)}):this.setState({focusedKeys:n.concat([t]),visibleKeys:a.concat([t])})}}},{key:"handleLegendHover",value:function(e){if("mouseleave"===e.type||"blur"===e.type)this.setState({focusedKeys:[]});else if("mouseenter"===e.type||"focus"===e.type){var t=e.currentTarget.id.split("__").pop();this.setState({focusedKeys:[t]})}}},{key:"updateDimensions",value:function(){this.setState({width:this.chartBodyRef.current.offsetWidth})}},{key:"getVisibleData",value:function(e,t){var r=t.filter((function(e){return e.visible}));return e.map((function(e){var t={date:e.date};return r.forEach((function(r){t[r.key]=e[r.key]})),t}))}},{key:"setInterval",value:function(e){var t=this.props,r=t.path,n=t.query;Object(l.j)({interval:e},r,n)}},{key:"renderIntervalSelector",value:function(){var e=this.props,t=e.interval,r=e.allowedIntervals;if(!r||r.length<1)return null;var o={hour:Object(a.__)("By hour","funnel-builder"),day:Object(a.__)("By day","funnel-builder"),week:Object(a.__)("By week","funnel-builder"),month:Object(a.__)("By month","funnel-builder"),quarter:Object(a.__)("By quarter","funnel-builder"),year:Object(a.__)("By year","funnel-builder")};return Object(n.createElement)(f.SelectControl,{value:t,options:r.map((function(e){return{value:e,label:o[e]}})),onChange:this.setInterval})}},{key:"getChartHeight",value:function(){var e=this.props,t=e.isViewportLarge;return e.isViewportMobile?180:t?300:220}},{key:"getLegendPosition",value:function(){var e=this.props,t=e.legendPosition,r=e.mode,n=e.isViewportWide;return t||(n&&"time-comparison"===r?"top":n&&"item-comparison"===r?"side":"bottom")}},{key:"render",value:function(){var e=this.state,t=e.focusedKeys,r=e.visibleKeys,i=e.width,c=this.props,u=c.baseValue,s=c.chartType,p=c.data,d=c.dateParser,y=c.emptyMessage,m=c.filterParam,v=c.interactiveLegend,g=c.interval,O=c.isRequesting,j=c.isViewportLarge,w=c.itemsLabel,S=c.mode,E=c.query,_=c.screenReaderFormat,k=c.showHeaderControls,F=c.title,C=c.tooltipLabelFormat,R=c.tooltipValueFormat,P=c.tooltipTitle,x=c.valueType,D=c.xFormat,T=c.x2Format,N=c.yBelow1Format,q=c.yFormat,A=m?Object(l.e)(E[m]):[],I=this.getOrderedKeys(t,r,A),M=O?null:this.getVisibleData(p,I),L=this.getLegendPosition(),B="top"===L?"row":"column",V="side"===L?"row":"column",K=this.getChartHeight(),U=O?null:Object(n.createElement)(An,{colorScheme:vr.a,data:I,handleLegendHover:this.handleLegendHover,handleLegendToggle:this.handleLegendToggle,interactive:v,legendDirection:B,legendValueFormat:R,totalLabel:Object(a.sprintf)(w,I.length)}),Y=q,H=N;if(!q)switch(x){case"average":Y=",.0f";break;case"currency":Y="$.3~s",H="$.3~f";break;case"number":Y=",.0f"}return Object(n.createElement)("div",{className:"bwf-chart"},k&&Object(n.createElement)("div",{className:"bwf-chart-header"},Object(n.createElement)(me.a,{className:"bwf-chart-title"},F),"top"===L&&U,this.renderIntervalSelector(),Object(n.createElement)(f.NavigableMenu,{className:"bwf-chart-types",orientation:"horizontal",role:"menubar"},Object(n.createElement)(f.Button,{className:h()("bwf-chart-type-button",{"bwf-chart-type-button-selected":"line"===s}),title:Object(a.__)("Line chart","funnel-builder"),"aria-checked":"line"===s,role:"menuitemradio",tabIndex:"line"===s?0:-1,onClick:Object(o.partial)(this.handleTypeToggle,"line")},Object(n.createElement)(b.a,{icon:"line-graph"})),Object(n.createElement)(f.Button,{className:h()("bwf-chart-type-button",{"bwf-chart-type-button-selected":"bar"===s}),title:Object(a.__)("Bar chart","funnel-builder"),"aria-checked":"bar"===s,role:"menuitemradio",tabIndex:"bar"===s?0:-1,onClick:Object(o.partial)(this.handleTypeToggle,"bar")},Object(n.createElement)(b.a,{icon:"stats-alt"})))),Object(n.createElement)(me.b,{component:!1},Object(n.createElement)("div",{className:h()("bwf-chart-body","bwf-chart-body-".concat(V)),ref:this.chartBodyRef},"side"===L&&U,O&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("span",{className:"screen-reader-text"},Object(a.__)("Your requested data is loading","funnel-builder")),Object(n.createElement)(Rr,{height:K})),!O&&i>0&&Object(n.createElement)(Cn,{baseValue:u,chartType:s,colorScheme:vr.a,data:M,dateParser:d,height:K,emptyMessage:y,interval:g,margin:{bottom:50,left:80,right:30,top:0},mode:S,orderedKeys:I,screenReaderFormat:_,tooltipLabelFormat:C,tooltipValueFormat:R,tooltipPosition:j?"over":"below",tooltipTitle:P,valueType:x,width:"row"===V?i-320:i,xFormat:D,x2Format:T,yBelow1Format:H,yFormat:Y})),"bottom"===L&&Object(n.createElement)("div",{className:"bwf-chart-footer"},U)))}}])&&Bn(t.prototype,r),i&&Bn(t,i),u}(n.Component);zn.propTypes={allowedIntervals:c.a.array,baseValue:c.a.number,chartType:c.a.oneOf(["bar","line"]),data:c.a.array.isRequired,dateParser:c.a.string.isRequired,emptyMessage:c.a.string,filterParam:c.a.string,itemsLabel:c.a.string,mode:c.a.oneOf(["item-comparison","time-comparison"]),path:c.a.string,query:c.a.object,interactiveLegend:c.a.bool,interval:c.a.oneOf(["hour","day","week","month","quarter","year"]),intervalData:c.a.object,isRequesting:c.a.bool,legendPosition:c.a.oneOf(["bottom","side","top"]),legendTotals:c.a.object,screenReaderFormat:c.a.oneOfType([c.a.string,c.a.func]),showHeaderControls:c.a.bool,title:c.a.string,tooltipLabelFormat:c.a.oneOfType([c.a.string,c.a.func]),tooltipValueFormat:c.a.oneOfType([c.a.string,c.a.func]),tooltipTitle:c.a.string,valueType:c.a.string,xFormat:c.a.string,x2Format:c.a.string,yBelow1Format:c.a.string,yFormat:c.a.string,currency:c.a.object},zn.defaultProps={baseValue:0,chartType:"line",data:[],dateParser:"%Y-%m-%dT%H:%M:%S",interactiveLegend:!0,interval:"day",isRequesting:!1,mode:"time-comparison",screenReaderFormat:"%B %-d, %Y",showHeaderControls:!0,tooltipLabelFormat:"%B %-d, %Y",tooltipValueFormat:",",xFormat:"%d",x2Format:"%b %Y",currency:{symbol:"$",symbolPosition:"left",decimalSeparator:".",thousandSeparator:","}};var $n=Object(Or.withViewportMatch)({isViewportMobile:"< medium",isViewportLarge:">= large",isViewportWide:">= wide"})(zn),Wn=function(e){var t=e.query,r=e.metrics,a=e.data,o=e.isLoading,i=e.interval,c=t.chartType,l=Object(pr.e)(),s=t.hasOwnProperty("chart")?t.chart:r&&r.hasOwnProperty("length")?r[0].key:"",f=r.find((function(e){return s===e.key})),p=Object(u.c)(t),b=Object(u.d)(t,"period=month&compare=previous_year"),d=b.primary,y=b.secondary,m=a.current,h=m.intervals,v=m.totals,g=void 0===v?{}:v,O=a.previous,j=O.intervals,w=O.totals,S=void 0===w?{}:w,E=h&&j?h.map((function(e,r){var n=Object(u.g)(e.start_date,d.after,y.after,t.compare,i),a=j[r];return{date:Object(mr.format)("Y-m-d\\TH:i:s",e.start_date),primary:{label:"".concat(d.label," (").concat(d.range,")"),labelDate:e.start_date,value:(f.isCurrency?l.formatDecimal(e.subtotals[s]):parseFloat(e.subtotals[s]))||0},secondary:{label:"".concat(y.label," (").concat(y.range,")"),labelDate:n.format("YYYY-MM-DD HH:mm:ss"),value:a&&(f.isCurrency?l.formatDecimal(a.subtotals[s]):parseFloat(a.subtotals[s]))||0}}})):[];Object(n.useEffect)((function(){window.onload=function(){window.dispatchEvent(new Event("resize"))}}),[]);var _=Object(u.e)(i,h.length);return Object(n.createElement)($n,{allowedIntervals:p,interval:i,isRequesting:o,data:E,chartType:c||"line",title:"Chart",layout:"item-comparison",legendTotals:{primary:g.hasOwnProperty(s)?f.isCurrency?l.formatDecimal(g[s]):g[s]:0,secondary:S.hasOwnProperty(s)?f.isCurrency?l.formatDecimal(S[s]):S[s]:0},xFormat:_.xFormat,x2Format:_.x2Format,screenReaderFormat:_.screenReaderFormat,tooltipLabelFormat:_.tooltipLabelFormat})};Wn.defaultProps={data:{current:{intervals:[],totals:{}},previous:{intervals:[],totals:{}}},isLoading:!1};var Gn=Wn,Jn=r(240);function Xn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Zn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xn(Object(r),!0).forEach((function(t){ea(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ea(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ta(e){return function(e){if(Array.isArray(e))return ra(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ra(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ra(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var na=function(e){var t=e.data,r=e.isLoading,o=Object(pr.e)(),i=function(e){return e.hasOwnProperty("object_name")&&e.object_name?e.object_name:e.object_id},c=function(e){var t=i(e),r="",a=!1;switch(e.type){case"sales":case"landing":r="welcome-widgets-menus";break;case"optin":r="email";break;case"optin_ty":r="thumbs-up";break;case"checkout":r="cart";break;case"bump":r="yes-alt";break;case"upsell":r="tag";break;case"offer":r="editor-break dashicons-x-axis";break;case"thankyou":r="thumbs-up"}return!0===e.ab&&(a=!0),Object(n.createElement)("div",{className:"bwf-c-contact-details-cell"},Object(n.createElement)("span",{className:"dashicons dashicons-"+r}),t,!0===a&&Object(n.createElement)("span",{className:"bwf-c-s-h"},"Variant"))},l=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return"type"in e&&"upsell"===e.type?"":e[t]&&""!==e[t]&&parseInt(e[t])?r?o.formatAmount(e[t]):n?"".concat(e[t],"%"):e[t]:"-"},u=[{key:"step",label:Object(a.__)("Step","funnel-builder"),required:!0,cellClassName:"bwf-col-step"},{key:"views",label:Object(a.__)("Views","funnel-builder"),cellClassName:"bwf-col-stats-m"},{key:"conversions",label:Object(a.__)("Conversions","funnel-builder"),cellClassName:"bwf-col-stats-m"},{key:"revenue",label:Object(a.__)("Revenue","funnel-builder"),cellClassName:"bwf-col-stats-m"},{key:"conversion_rate",label:Object(a.__)("Conversion Rate","funnel-builder"),cellClassName:"bwf-col-stats-m"}],s=t?t.map((function(e){return"upsell"===e.type?"bwf-s-upsell":""})):[],f=function(){if(!t)return[];var e=t.reduce((function(e,t,r){return t.hasOwnProperty("offers")?[].concat(ta(e),[r]):e}),[]),r=0,n=e.map((function(e){var n=t.slice(r,e+1);r=e+1;var a=n[n.length-1],o=!!a.hasOwnProperty("offers")&&a.offers,i=Object.keys(o).map((function(e){return Zn(Zn({},o[e]),{},{type:"offer"})}));return o?n.concat(i):n}));return r+1<=t.length&&n.push(t.slice(r,t.length)),n.reduce((function(e,t){return e.concat(t)}),[])}().map((function(e){return[{display:c(e),value:i(e)},{display:l(e,"views"),value:e.views},{display:l(e,"conversions"),value:e.conversions},{display:l(e,"revenue",!0),value:e.revenue},{display:l(e,"conversion_rate",!1,!0),value:e.conversion_rate}]}));return Object(n.createElement)(Jn.a,{isLoading:r,title:"",rows:f,rowClasses:s,headers:u,rowHeader:!0,totalRows:f.length||1,rowsPerPage:f.length||1})},aa=function(e){var t=e.onRequestClose;return e.isOpen?Object(n.createElement)(n.Fragment,null,Object(n.createElement)(f.Modal,{className:"bwf-admin-modal bwf-admin-modal-medium bwf-admin-modal-no-header",isDismissible:!0,onRequestClose:function(){return t()}},Object(n.createElement)("div",{className:"bwf_clear"}),Object(n.createElement)("div",{className:"bwf-t-center"},Object(n.createElement)("div",{className:"bwf-h1 bwf_align_center"},Object(n.createElement)(f.Icon,{icon:"lock",size:"30",style:{marginRight:5}})," ",Object(a.__)("Analytics is a PRO feature!","funnel-builder")),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-p"},Object(a.__)("Unlock this Pro feature now and experience the fully-loaded version.","funnel-builder"))),Object(n.createElement)("div",{className:"bwf_clear_30"}),Object(n.createElement)("div",{className:"bwf-t-center bwf-buttons-wrapper"},Object(n.createElement)(f.Button,{isSecondary:!0,onClick:function(){return t()}},Object(a.__)("Try Demo","funnel-builder")),Object(n.createElement)("a",{isPrimary:!0,href:"https://buildwoofunnels.com/exclusive-offer/",className:"components-button is-primary"},Object(a.__)("Upgrade to PRO","funnel-builder"))))):null};aa.defaultProps={closeAnimationInProgress:function(){},isOpen:!1,onRequestClose:function(){}};var oa=aa},507:function(e,t,r){},508:function(e,t,r){},509:function(e,t,r){},510:function(e,t,r){},511:function(e,t,r){},512:function(e,t,r){},513:function(e,t,r){},517:function(e,t,r){},89:function(e,t,r){"use strict";var n=r(0),a=r(10),o=r(3),i=r(11),c=r.n(i),l=r(235),u=r.n(l),s=r(5),f=r(1),p=r.n(f),b=r(236),d=function(e){var t,r=e.delta,i=e.href,l=e.hrefType,f=e.isOpen,p=e.label,d=e.onToggle,y=e.prevLabel,m=e.prevValue,h=e.reverseTrend,v=e.selected,g=e.value,O=e.onLinkClickCallback,j=c()("bwf-summary-item-container",{"is-dropdown-button":d,"is-dropdown-expanded":f}),w=c()("bwf-summary-item",{"is-selected":v,"is-good-trend":h?r<0:r>0,"is-bad-trend":h?r>0:r<0}),S=r>0?Object(o.sprintf)(Object(o.__)("Up %d%% from %s","funnel-builder"),r,y):Object(o.sprintf)(Object(o.__)("Down %d%% from %s","funnel-builder"),Math.abs(r),y);r||(S=Object(o.sprintf)(Object(o.__)("No change from %s","funnel-builder"),y));var E={className:w,"aria-current":v?"page":null};if(d||i){var _=!!d;t=_?a.Button:b.a,_?(E.onClick=d,E["aria-expanded"]=f):(E.href=i,E.role="menuitem",E.onClick=O,E.type=l)}else t="div";return Object(n.createElement)("li",{className:j},Object(n.createElement)(t,E,Object(n.createElement)("div",{className:"bwf-summary-item-label"},Object(n.createElement)(a.__experimentalText,{variant:"body.small"},p)),Object(n.createElement)("div",{className:"bwf-summary-item-data"},Object(n.createElement)("div",{className:"bwf-summary-item-value"},Object(n.createElement)(a.__experimentalText,{variant:"title.small"},Object(s.isNil)(g)?Object(o.__)("N/A","funnel-builder"):g)),Object(n.createElement)(a.Tooltip,{text:Object(s.isNil)(m)?Object(o.__)("N/A","funnel-builder"):"".concat(y," ").concat(m),position:"top center"},Object(n.createElement)("div",{className:"bwf-summary-item-delta",role:"presentation","aria-label":S},Object(n.createElement)(a.__experimentalText,{variant:"caption"},Object(s.isNil)(r)?Object(o.__)("N/A","funnel-builder"):Object(o.sprintf)(Object(o.__)("%d%%","funnel-builder"),r))))),d?Object(n.createElement)(u.a,{className:"bwf-summary-toggle",icon:"chevron-down",size:24}):null))};d.propTypes={delta:p.a.number,href:p.a.string,hrefType:p.a.oneOf(["wp-admin","wc-admin","external"]).isRequired,isOpen:p.a.bool,label:p.a.string.isRequired,onToggle:p.a.func,prevLabel:p.a.string,prevValue:p.a.oneOfType([p.a.number,p.a.string]),reverseTrend:p.a.bool,selected:p.a.bool,value:p.a.oneOfType([p.a.number,p.a.string]),onLinkClickCallback:p.a.func},d.defaultProps={href:"",hrefType:"wc-admin",isOpen:!1,prevLabel:Object(o.__)("Previous Period:","funnel-builder"),reverseTrend:!1,selected:!1,onLinkClickCallback:s.noop},t.a=d}}]);