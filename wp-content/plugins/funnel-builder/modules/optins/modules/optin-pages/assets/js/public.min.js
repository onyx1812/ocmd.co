"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(o){({init:function(){var n=this;o(document).ready(function(e){n.renderForm(),n.handleSubmit(),n.renderPBPopUps(),n.attachCloseBtn(),n.initPhoneFlag()}),o(document).on("wffn_reload_popups",function(){n.renderPBPopUps()}),o(document).on("wffn_reload_phone_field",function(){n.initPhoneFlag()})},initPhoneFlag:function(){var e=document.querySelectorAll(".phone_flag_code input[type='tel']");for(var n in e)"object"===_typeof(e[n])&&void 0!==window.intlTelInput&&window.intlTelInput(e[n],{initialCountry:"auto",separateDialCode:!0,geoIpLookup:function(t){o.get("https://ipinfo.io",function(){},"jsonp").always(function(e){var n=e&&e.country?e.country:"us";t(n)})}})},attachCloseBtn:function(){jQuery(document).on("click",".bwf_pp_close",function(e){e.preventDefault(),jQuery(".bwf_pp_overlay").removeClass("show_popup_form")})},renderPBPopUps:function(){jQuery(".wfop_pb_widget_wrap").each(function(){var n=this;jQuery(this).find(".bwf-custom-button a").click(function(e){e.preventDefault(),jQuery(n).find(".bwf_pp_overlay").addClass("show_popup_form")})})},renderForm:function(){0<jQuery(".bwf_pp_overlay").length&&jQuery('a[href*="wfop-popup=yes"]').on("click",function(e){e.preventDefault(),jQuery(".bwf_pp_overlay").addClass("show_popup_form")})},DoValidation:function(r){var a=!0;return jQuery(r).find(".wfop_required").each(function(){var e=jQuery(this),n=null,t=window.wffnfunnelVars.op_valid_text,o=window.wffnfunnelVars.op_valid_email;if(""===jQuery.trim(e.val()))n=t;else if("checkbox"===e.attr("type"))e.prop("checked")||(n=t);else if("radio"===e.attr("type")){var i=e.attr("name");0===jQuery(r).find("input:radio[name="+i+"]:checked").length&&(n=t)}if(""!==jQuery.trim(e.val())&&"wfop_optin_email"===e.attr("name")){jQuery.trim(e.val()).match(/^([\w-.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(]?)$/)||(n=o)}null!==n&&(e.parents(".bwfac_form_sec").addClass("bwfac_error"),0===e.parents(".bwfac_form_sec").find(".error").length&&e.parents(".bwfac_form_sec").append('<span class="error">'+n+"</span>"),a=!1)}),a},setUpClick:function(u){var p=this;jQuery(u).find("#wffn_custom_optin_submit").on("click",function(e){var n=!0;jQuery(this).removeAttr("disabled");var t=u;jQuery(t).find(".bwfac_form_sec").removeClass("bwfac_error"),jQuery(t).find(".bwfac_form_sec .error").remove();var o=jQuery(t).find("input[name=optin_is_admin]").val(),i=jQuery(t).find("input[name=optin_is_ajax]").val(),r=jQuery(t).find("input[name=optin_is_preview]").val();if(console.log("Is Admin: "+o+" Is Ajax: "+i+" Is preview: "+r),(o||i||r)&&(console.log("Returning"),n=!1),n=p.DoValidation(u),e.preventDefault(),n){jQuery(this).attr("disabled","disabled");var a=jQuery(this).attr("data-subitting-text");if(jQuery(u).find("button.wfop_submit_btn .bwf_heading").html(a),void 0!==window.intlTelInputGlobals&&"undefined"!==jQuery(u).find('input[name="wfop_optin_phone"]').get(0)){var f=window.intlTelInputGlobals.getInstance(jQuery(u).find('input[name="wfop_optin_phone"]').get(0)).getSelectedCountryData();jQuery(u).find('input[name="wfop_optin_phone_dialcode"]').eq(0).val("+"+f.dialCode)}jQuery.ajax({url:window.wffnfunnelVars.ajaxUrl+"?action=wffn_submit_custom_optin_form",data:jQuery(u).serialize(),dataType:"json",type:"post"}).always(function(e){if(Object.prototype.hasOwnProperty.call(e,"mapped")){for(var n in e.mapped)jQuery(".wfop_integration_form input[name='"+n+"']").val(e.mapped[n]);jQuery(".wfop_integration_form").trigger("submit")}else Object.prototype.hasOwnProperty.call(e,"next_url")&&""!==e.next_url&&(window.location.href=e.next_url)})}else console.log("form validation failed")})},handleSubmit:function(){var e=this;jQuery("form.wffn-custom-optin-from").each(function(){e.setUpClick(this)})}}).init()}(jQuery);